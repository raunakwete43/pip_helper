"use strict";(self.webpackChunk_jupyter_lsp_jupyterlab_lsp=self.webpackChunk_jupyter_lsp_jupyterlab_lsp||[]).push([[661],{4988:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(7796),o=n.n(i),r=n(1051),s=n.n(r)()(o());s.push([e.id,".lsp-floating-console {\n  position: absolute;\n  width: 600px;\n  min-height: 350px;\n  height: 25%;\n  right: 0;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.8);\n  border: 3px solid rgba(204, 204, 204, 0.7);\n  font-size: 12px;\n  overflow-y: auto;\n  margin: 0;\n  list-style-type: none;\n  padding: 5px;\n  z-index: 100;\n}\n\n.lsp-code {\n  font-family: monospace;\n  background: #eee;\n  border-radius: 2px;\n  padding: 2px 5px;\n}\n\n.lsp-kind {\n  padding: 2px 5px;\n}\n","",{version:3,sources:["webpack://./style/console.css"],names:[],mappings:"AAAA;EACE,kBAAkB;EAClB,YAAY;EACZ,iBAAiB;EACjB,WAAW;EACX,QAAQ;EACR,SAAS;EACT,oCAAoC;EACpC,0CAA0C;EAC1C,eAAe;EACf,gBAAgB;EAChB,SAAS;EACT,qBAAqB;EACrB,YAAY;EACZ,YAAY;AACd;;AAEA;EACE,sBAAsB;EACtB,gBAAgB;EAChB,kBAAkB;EAClB,gBAAgB;AAClB;;AAEA;EACE,gBAAgB;AAClB",sourcesContent:[".lsp-floating-console {\n  position: absolute;\n  width: 600px;\n  min-height: 350px;\n  height: 25%;\n  right: 0;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.8);\n  border: 3px solid rgba(204, 204, 204, 0.7);\n  font-size: 12px;\n  overflow-y: auto;\n  margin: 0;\n  list-style-type: none;\n  padding: 5px;\n  z-index: 100;\n}\n\n.lsp-code {\n  font-family: monospace;\n  background: #eee;\n  border-radius: 2px;\n  padding: 2px 5px;\n}\n\n.lsp-kind {\n  padding: 2px 5px;\n}\n"],sourceRoot:""}]);const a=s},2372:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(7796),o=n.n(i),r=n(1051),s=n.n(r)()(o());s.push([e.id,".lsp-diagnostics-panel-content {\n  overflow-y: auto;\n}\n\n.lsp-diagnostics-placeholder {\n  padding: 8px;\n  color: var(--jp-content-font-color2);\n  text-align: center;\n}\n\n.lsp-diagnostics-placeholder > h3 {\n  margin-bottom: var(--jp-content-heading-margin-bottom);\n}\n\n.lsp-diagnostics-listing {\n  color: var(--jp-ui-font-color1);\n  background: var(--jp-layout-color1);\n  font-size: var(--jp-ui-font-size1);\n  border-spacing: 0;\n  /* required to preserve borders of `<th>` when using position:sticky */\n  border-collapse: separate;\n  width: 100%;\n}\n\n.lsp-diagnostics-listing thead {\n  box-shadow: var(--jp-toolbar-box-shadow);\n}\n\n.lsp-diagnostics-listing tbody {\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n\n.lsp-diagnostics-listing th,\n.lsp-diagnostics-listing td {\n  padding: 4px 12px 2px 12px;\n  height: 18px;\n}\n\n.lsp-diagnostics-listing th {\n  font-weight: 500;\n  text-align: left;\n  border-bottom: var(--jp-border-width) solid var(--jp-border-color1);\n  background: var(--jp-layout-color1);\n  position: sticky;\n  top: 0;\n  z-index: 2;\n  white-space: nowrap;\n  user-select: none;\n}\n\n.lsp-diagnostics-listing th:not(:first-child) {\n  border-left: var(--jp-border-width) solid var(--jp-border-color2);\n}\n\n.lsp-diagnostics-listing th:hover {\n  background: var(--jp-layout-color2);\n}\n\n.lsp-diagnostics-listing tbody tr:hover {\n  background: var(--jp-layout-color2);\n}\n\n.lsp-diagnostics-listing thead th > div {\n  flex-direction: row;\n  display: flex;\n}\n\n.lsp-diagnostics-listing thead th > div > label {\n  flex: 1;\n  text-overflow: ellipsis;\n}\n\n.lsp-sort-icon {\n  flex: 0;\n  height: var(--jp-ui-font-size1);\n  width: var(--jp-ui-font-size1);\n}\n\n.lsp-sort-icon svg {\n  display: inline;\n  height: auto;\n}\n\n.lsp-diagnostics-listing thead th:not(.lsp-sorted-header) .lsp-sort-icon {\n  opacity: 0;\n}\n\n.lsp-diagnostics-listing thead th:not(.lsp-sorted-header):hover .lsp-sort-icon {\n  opacity: 0.5;\n}\n","",{version:3,sources:["webpack://./style/diagnostics_listing.css"],names:[],mappings:"AAAA;EACE,gBAAgB;AAClB;;AAEA;EACE,YAAY;EACZ,oCAAoC;EACpC,kBAAkB;AACpB;;AAEA;EACE,sDAAsD;AACxD;;AAEA;EACE,+BAA+B;EAC/B,mCAAmC;EACnC,kCAAkC;EAClC,iBAAiB;EACjB,sEAAsE;EACtE,yBAAyB;EACzB,WAAW;AACb;;AAEA;EACE,wCAAwC;AAC1C;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;AACpB;;AAEA;;EAEE,0BAA0B;EAC1B,YAAY;AACd;;AAEA;EACE,gBAAgB;EAChB,gBAAgB;EAChB,mEAAmE;EACnE,mCAAmC;EACnC,gBAAgB;EAChB,MAAM;EACN,UAAU;EACV,mBAAmB;EACnB,iBAAiB;AACnB;;AAEA;EACE,iEAAiE;AACnE;;AAEA;EACE,mCAAmC;AACrC;;AAEA;EACE,mCAAmC;AACrC;;AAEA;EACE,mBAAmB;EACnB,aAAa;AACf;;AAEA;EACE,OAAO;EACP,uBAAuB;AACzB;;AAEA;EACE,OAAO;EACP,+BAA+B;EAC/B,8BAA8B;AAChC;;AAEA;EACE,eAAe;EACf,YAAY;AACd;;AAEA;EACE,UAAU;AACZ;;AAEA;EACE,YAAY;AACd",sourcesContent:[".lsp-diagnostics-panel-content {\n  overflow-y: auto;\n}\n\n.lsp-diagnostics-placeholder {\n  padding: 8px;\n  color: var(--jp-content-font-color2);\n  text-align: center;\n}\n\n.lsp-diagnostics-placeholder > h3 {\n  margin-bottom: var(--jp-content-heading-margin-bottom);\n}\n\n.lsp-diagnostics-listing {\n  color: var(--jp-ui-font-color1);\n  background: var(--jp-layout-color1);\n  font-size: var(--jp-ui-font-size1);\n  border-spacing: 0;\n  /* required to preserve borders of `<th>` when using position:sticky */\n  border-collapse: separate;\n  width: 100%;\n}\n\n.lsp-diagnostics-listing thead {\n  box-shadow: var(--jp-toolbar-box-shadow);\n}\n\n.lsp-diagnostics-listing tbody {\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n\n.lsp-diagnostics-listing th,\n.lsp-diagnostics-listing td {\n  padding: 4px 12px 2px 12px;\n  height: 18px;\n}\n\n.lsp-diagnostics-listing th {\n  font-weight: 500;\n  text-align: left;\n  border-bottom: var(--jp-border-width) solid var(--jp-border-color1);\n  background: var(--jp-layout-color1);\n  position: sticky;\n  top: 0;\n  z-index: 2;\n  white-space: nowrap;\n  user-select: none;\n}\n\n.lsp-diagnostics-listing th:not(:first-child) {\n  border-left: var(--jp-border-width) solid var(--jp-border-color2);\n}\n\n.lsp-diagnostics-listing th:hover {\n  background: var(--jp-layout-color2);\n}\n\n.lsp-diagnostics-listing tbody tr:hover {\n  background: var(--jp-layout-color2);\n}\n\n.lsp-diagnostics-listing thead th > div {\n  flex-direction: row;\n  display: flex;\n}\n\n.lsp-diagnostics-listing thead th > div > label {\n  flex: 1;\n  text-overflow: ellipsis;\n}\n\n.lsp-sort-icon {\n  flex: 0;\n  height: var(--jp-ui-font-size1);\n  width: var(--jp-ui-font-size1);\n}\n\n.lsp-sort-icon svg {\n  display: inline;\n  height: auto;\n}\n\n.lsp-diagnostics-listing thead th:not(.lsp-sorted-header) .lsp-sort-icon {\n  opacity: 0;\n}\n\n.lsp-diagnostics-listing thead th:not(.lsp-sorted-header):hover .lsp-sort-icon {\n  opacity: 0.5;\n}\n"],sourceRoot:""}]);const a=s},3075:(e,t,n)=>{n.d(t,{Z:()=>p});var i=n(7796),o=n.n(i),r=n(1051),s=n.n(r),a=n(8996),l=n(6801),c=n(2361),d=n(6143),u=s()(o());u.i(a.Z),u.i(l.Z),u.i(c.Z),u.i(d.Z),u.push([e.id,'.cm-lsp-diagnostic-tag-Unnecessary {\n  /*\n   * LSP: "Clients are allowed to render diagnostics with this tag faded out instead of having an error squiggle."\n   */\n  filter: grayscale(1);\n  opacity: 0.7;\n  text-decoration: none !important;\n}\n\n.cm-lsp-diagnostic-tag-Deprecated {\n  /*\n   * LSP: "Clients are allowed to rendered diagnostics with this tag strike through."\n   */\n  text-decoration: line-through !important;\n}\n\n/* hover */\n.cm-lsp-hover-available {\n  text-decoration: var(--jp-editor-mirror-lsp-hover-decoration-style);\n  text-decoration-color: var(--jp-editor-mirror-lsp-hover-decoration-color);\n  text-decoration-line: underline;\n  text-decoration-skip-ink: none;\n}\n\n/* highlight */\n.cm-lsp-highlight-Read {\n  /* highlight on places where variable is accessed, e.g. `print(var)` */\n  background-color: var(--jp-editor-mirror-lsp-highlight-background-color);\n  outline: 1px solid var(--jp-editor-mirror-lsp-highlight-background-color);\n}\n\n.cm-lsp-highlight-Write {\n  /* highlight on places where variable is defined, e.g. `var = 1` */\n  background-color: var(--jp-editor-mirror-lsp-highlight-background-color);\n  outline: 1px solid var(--jp-editor-mirror-lsp-highlight-border-color);\n}\n\n.cm-lsp-highlight-Text {\n  /* highlight on places where variable was matched based on text rather than semantics */\n  background-color: var(--jp-editor-mirror-lsp-highlight-background-color);\n}\n',"",{version:3,sources:["webpack://./style/highlight.css"],names:[],mappings:"AAKA;EACE;;IAEE;EACF,oBAAoB;EACpB,YAAY;EACZ,gCAAgC;AAClC;;AAEA;EACE;;IAEE;EACF,wCAAwC;AAC1C;;AAEA,UAAU;AACV;EACE,mEAAmE;EACnE,yEAAyE;EACzE,+BAA+B;EAC/B,8BAA8B;AAChC;;AAEA,cAAc;AACd;EACE,sEAAsE;EACtE,wEAAwE;EACxE,yEAAyE;AAC3E;;AAEA;EACE,kEAAkE;EAClE,wEAAwE;EACxE,qEAAqE;AACvE;;AAEA;EACE,uFAAuF;EACvF,wEAAwE;AAC1E",sourcesContent:["@import url('./variables/base.css');\n@import url('./variables/cm-themes.css');\n@import url('./variables/jupyterlab-dark.css');\n@import url('./variables/jupyterlab-light.css');\n\n.cm-lsp-diagnostic-tag-Unnecessary {\n  /*\n   * LSP: \"Clients are allowed to render diagnostics with this tag faded out instead of having an error squiggle.\"\n   */\n  filter: grayscale(1);\n  opacity: 0.7;\n  text-decoration: none !important;\n}\n\n.cm-lsp-diagnostic-tag-Deprecated {\n  /*\n   * LSP: \"Clients are allowed to rendered diagnostics with this tag strike through.\"\n   */\n  text-decoration: line-through !important;\n}\n\n/* hover */\n.cm-lsp-hover-available {\n  text-decoration: var(--jp-editor-mirror-lsp-hover-decoration-style);\n  text-decoration-color: var(--jp-editor-mirror-lsp-hover-decoration-color);\n  text-decoration-line: underline;\n  text-decoration-skip-ink: none;\n}\n\n/* highlight */\n.cm-lsp-highlight-Read {\n  /* highlight on places where variable is accessed, e.g. `print(var)` */\n  background-color: var(--jp-editor-mirror-lsp-highlight-background-color);\n  outline: 1px solid var(--jp-editor-mirror-lsp-highlight-background-color);\n}\n\n.cm-lsp-highlight-Write {\n  /* highlight on places where variable is defined, e.g. `var = 1` */\n  background-color: var(--jp-editor-mirror-lsp-highlight-background-color);\n  outline: 1px solid var(--jp-editor-mirror-lsp-highlight-border-color);\n}\n\n.cm-lsp-highlight-Text {\n  /* highlight on places where variable was matched based on text rather than semantics */\n  background-color: var(--jp-editor-mirror-lsp-highlight-background-color);\n}\n"],sourceRoot:""}]);const p=u},4599:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(7796),o=n.n(i),r=n(1051),s=n.n(r),a=n(3075),l=n(9538),c=n(4302),d=s()(o());d.i(a.Z),d.i(l.Z),d.i(c.Z),d.push([e.id,".lsp-document-locator:hover {\n  cursor: pointer;\n}\n\n.lsp-document-locator span:not(:last-child)::after {\n  content: ' > ';\n}\n\n.lsp-icon-flip-x {\n  transform: scaleX(-1);\n  transform-origin: center center;\n}\n\n.lsp-external-link {\n  color: var(--jp-content-link-color);\n}\n\n.lsp-ServerSettings-list {\n  grid-area: listing;\n  min-width: 175px;\n}\n\n.lsp-ServerSettings-list ul {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n\n.lsp-ServerSettings-list li {\n  text-overflow: ellipsis;\n  overflow-x: hidden;\n  white-space: nowrap;\n  padding: 3px 0;\n  border-left: 3px solid transparent;\n  padding-left: 4px;\n}\n\n.lsp-ServerSettings-title {\n  font-size: var(--jp-content-font-size2);\n  color: var(--jp-ui-font-color0);\n  font-weight: 300;\n  margin: 0;\n  padding: 0;\n}\n\n.lsp-ServerSettings-list-group {\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 1px;\n  font-size: var(--jp-ui-font-size0);\n  padding: 8px 8px 8px 12px;\n  margin: 10px;\n  border-bottom: var(--jp-border-width) solid var(--jp-border-color2);\n  border-top: var(--jp-border-width) solid var(--jp-border-color2);\n  color: var(--jp-content-font-color1);\n}\n\n.lsp-ServerSettings-list li.lsp-selected {\n  border-color: var(--jp-brand-color1);\n}\n\n.lsp-ServerSettings-list li:hover {\n  background-color: var(--jp-layout-color2);\n  transition: background-color 100ms ease-in-out;\n}\n\n.lsp-ServerSettings-content {\n  grid-area: content;\n  min-width: 0;\n  width: 100%;\n  overflow-y: scroll;\n  max-height: 1000px;\n}\n\n.lsp-ServerSettings-content-name {\n  font-size: var(--jp-content-font-size2);\n  color: var(--jp-ui-font-color0);\n  font-weight: normal;\n  margin: 1em;\n}\n\n.lsp-ServerSettings-content-specOverrides {\n  margin: 1em;\n}\n\n.lsp-ServerSettings-content > .form-group {\n  padding-top: 0;\n}\n\n.lsp-ServerSettings-content .lsp-server-links-list {\n  margin: 0;\n}\n\n.lsp-ServerSettings-tabs {\n  display: grid;\n  grid-template: 'listing content';\n}\n","",{version:3,sources:["webpack://./style/index.css"],names:[],mappings:"AAIA;EACE,eAAe;AACjB;;AAEA;EACE,cAAc;AAChB;;AAEA;EACE,qBAAqB;EACrB,+BAA+B;AACjC;;AAEA;EACE,mCAAmC;AACrC;;AAEA;EACE,kBAAkB;EAClB,gBAAgB;AAClB;;AAEA;EACE,gBAAgB;EAChB,SAAS;EACT,UAAU;AACZ;;AAEA;EACE,uBAAuB;EACvB,kBAAkB;EAClB,mBAAmB;EACnB,cAAc;EACd,kCAAkC;EAClC,iBAAiB;AACnB;;AAEA;EACE,uCAAuC;EACvC,+BAA+B;EAC/B,gBAAgB;EAChB,SAAS;EACT,UAAU;AACZ;;AAEA;EACE,gBAAgB;EAChB,yBAAyB;EACzB,mBAAmB;EACnB,kCAAkC;EAClC,yBAAyB;EACzB,YAAY;EACZ,mEAAmE;EACnE,gEAAgE;EAChE,oCAAoC;AACtC;;AAEA;EACE,oCAAoC;AACtC;;AAEA;EACE,yCAAyC;EACzC,8CAA8C;AAChD;;AAEA;EACE,kBAAkB;EAClB,YAAY;EACZ,WAAW;EACX,kBAAkB;EAClB,kBAAkB;AACpB;;AAEA;EACE,uCAAuC;EACvC,+BAA+B;EAC/B,mBAAmB;EACnB,WAAW;AACb;;AAEA;EACE,WAAW;AACb;;AAEA;EACE,cAAc;AAChB;;AAEA;EACE,SAAS;AACX;;AAEA;EACE,aAAa;EACb,gCAAgC;AAClC",sourcesContent:["@import url('./highlight.css');\n@import url('./tooltip.css');\n@import url('./signature.css');\n\n.lsp-document-locator:hover {\n  cursor: pointer;\n}\n\n.lsp-document-locator span:not(:last-child)::after {\n  content: ' > ';\n}\n\n.lsp-icon-flip-x {\n  transform: scaleX(-1);\n  transform-origin: center center;\n}\n\n.lsp-external-link {\n  color: var(--jp-content-link-color);\n}\n\n.lsp-ServerSettings-list {\n  grid-area: listing;\n  min-width: 175px;\n}\n\n.lsp-ServerSettings-list ul {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n\n.lsp-ServerSettings-list li {\n  text-overflow: ellipsis;\n  overflow-x: hidden;\n  white-space: nowrap;\n  padding: 3px 0;\n  border-left: 3px solid transparent;\n  padding-left: 4px;\n}\n\n.lsp-ServerSettings-title {\n  font-size: var(--jp-content-font-size2);\n  color: var(--jp-ui-font-color0);\n  font-weight: 300;\n  margin: 0;\n  padding: 0;\n}\n\n.lsp-ServerSettings-list-group {\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 1px;\n  font-size: var(--jp-ui-font-size0);\n  padding: 8px 8px 8px 12px;\n  margin: 10px;\n  border-bottom: var(--jp-border-width) solid var(--jp-border-color2);\n  border-top: var(--jp-border-width) solid var(--jp-border-color2);\n  color: var(--jp-content-font-color1);\n}\n\n.lsp-ServerSettings-list li.lsp-selected {\n  border-color: var(--jp-brand-color1);\n}\n\n.lsp-ServerSettings-list li:hover {\n  background-color: var(--jp-layout-color2);\n  transition: background-color 100ms ease-in-out;\n}\n\n.lsp-ServerSettings-content {\n  grid-area: content;\n  min-width: 0;\n  width: 100%;\n  overflow-y: scroll;\n  max-height: 1000px;\n}\n\n.lsp-ServerSettings-content-name {\n  font-size: var(--jp-content-font-size2);\n  color: var(--jp-ui-font-color0);\n  font-weight: normal;\n  margin: 1em;\n}\n\n.lsp-ServerSettings-content-specOverrides {\n  margin: 1em;\n}\n\n.lsp-ServerSettings-content > .form-group {\n  padding-top: 0;\n}\n\n.lsp-ServerSettings-content .lsp-server-links-list {\n  margin: 0;\n}\n\n.lsp-ServerSettings-tabs {\n  display: grid;\n  grid-template: 'listing content';\n}\n"],sourceRoot:""}]);const u=d},4302:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(7796),o=n.n(i),r=n(1051),s=n.n(r)()(o());s.push([e.id,".lsp-signature-help code {\n  font-size: var(--jp-code-font-size);\n}\n\n.lsp-signature-help code > mark {\n  color: var(--jp-lsp-signature-mark-color);\n  background: var(--jp-lsp-signature-mark-background);\n}\n\n.lsp-signature-help code > mark > span {\n  /* override syntax highlight colour to ensure contrast */\n  color: var(--jp-lsp-signature-mark-color) !important;\n}\n","",{version:3,sources:["webpack://./style/signature.css"],names:[],mappings:"AAAA;EACE,mCAAmC;AACrC;;AAEA;EACE,yCAAyC;EACzC,mDAAmD;AACrD;;AAEA;EACE,wDAAwD;EACxD,oDAAoD;AACtD",sourcesContent:[".lsp-signature-help code {\n  font-size: var(--jp-code-font-size);\n}\n\n.lsp-signature-help code > mark {\n  color: var(--jp-lsp-signature-mark-color);\n  background: var(--jp-lsp-signature-mark-background);\n}\n\n.lsp-signature-help code > mark > span {\n  /* override syntax highlight colour to ensure contrast */\n  color: var(--jp-lsp-signature-mark-color) !important;\n}\n"],sourceRoot:""}]);const a=s},4929:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(7796),o=n.n(i),r=n(1051),s=n.n(r)()(o());s.push([e.id,".lsp-popover {\n  /* jupyterlab Menu */\n  z-index: 10000;\n  padding: 4px 0px;\n  background: var(--jp-layout-color0);\n  color: var(--jp-ui-font-color1);\n  border: var(--jp-border-width) solid var(--jp-border-color1);\n  font-size: var(--jp-ui-font-size1);\n  box-shadow: var(--jp-elevation-z6);\n}\n\n.lsp-popover-content {\n  padding: 5px 10px;\n}\n\n.lsp-servers-title {\n  margin-bottom: 5px;\n}\n\n.lsp-servers-menu {\n  height: 350px;\n  overflow-y: auto;\n}\n\n.lsp-server-status,\n.lsp-missing-server,\n.lsp-documents-by-language {\n  margin-left: 20px;\n}\n\nh5 .lsp-language-server-name {\n  color: var(--jp-ui-font-color2);\n}\n\n.lsp-documents-by-language ul,\n.lsp-server-status ul {\n  margin: 0;\n  padding-left: 25px;\n}\n\n.lsp-servers-menu h5 {\n  font-weight: normal;\n  font-size: 100%;\n  white-space: nowrap;\n}\n\n.lsp-servers-lists {\n  margin-left: 5px;\n}\n\n.lsp-popover-status {\n  padding-top: 5px;\n  border-top: 1px solid var(--jp-border-color1);\n}\n\n.lsp-popover-status a {\n  color: var(--jp-content-link-color);\n}\n\n.lsp-servers-menu h3,\nh4,\nh5 {\n  margin: 0;\n}\n\n.lsp-documents-by-language li {\n  width: 100%;\n  display: flex;\n  justify-content: space-between;\n}\n\n.lsp-document-status {\n  float: right;\n  padding-left: 15px;\n}\n\n.lsp-document-status-icon {\n  margin-left: 5px;\n  position: relative;\n  top: 3px;\n}\n\n.lsp-collapsible-list h4 {\n  cursor: pointer;\n}\n\n.lsp-collapsible-list .lsp-caret-icon {\n  position: relative;\n  top: 3px;\n}\n\n.lsp-collapsible-list.lsp-collapsed div {\n  display: none;\n}\n\n.lsp-statusbar-item {\n  overflow: hidden;\n  white-space: nowrap;\n}\n\n.lsp-status-icon.ready svg g {\n  fill: var(--jp-success-color0);\n}\n\n.lsp-status-icon.preparing svg g {\n  fill: var(--jp-warn-color0);\n}\n\n.lsp-status-icon.error svg g {\n  fill: var(--jp-error-color0);\n}\n\n.lsp-status-icon.inactive svg g {\n  fill: var(--jp-layout-color3);\n}\n\n.lsp-status-message {\n  user-select: none;\n}\n\nbody[data-jp-theme-light='false'] .lsp-status-icon.ready svg g {\n  fill: var(--jp-success-color1);\n}\n\n.lsp-statusbar-item.jp-mod-clicked .jp-icon-selectable[fill] {\n  fill: #fff;\n}\n\n.jp-ToolbarButton .lsp-status-icon svg {\n  top: 5px;\n}\n\n.lsp-help-button {\n  background: var(--jp-layout-color2);\n  border: 1px solid var(--jp-brand-color0);\n  float: right;\n}\n\n.lsp-help-button:hover {\n  background: var(--jp-layout-color3);\n}\n\n.lsp-server-links-list a {\n  color: var(--jp-content-link-color);\n}\n\n.lsp-troubleshoot-section {\n  white-space: pre-wrap;\n  margin: 10px 0;\n}\n","",{version:3,sources:["webpack://./style/statusbar.css"],names:[],mappings:"AAAA;EACE,oBAAoB;EACpB,cAAc;EACd,gBAAgB;EAChB,mCAAmC;EACnC,+BAA+B;EAC/B,4DAA4D;EAC5D,kCAAkC;EAClC,kCAAkC;AACpC;;AAEA;EACE,iBAAiB;AACnB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,aAAa;EACb,gBAAgB;AAClB;;AAEA;;;EAGE,iBAAiB;AACnB;;AAEA;EACE,+BAA+B;AACjC;;AAEA;;EAEE,SAAS;EACT,kBAAkB;AACpB;;AAEA;EACE,mBAAmB;EACnB,eAAe;EACf,mBAAmB;AACrB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,gBAAgB;EAChB,6CAA6C;AAC/C;;AAEA;EACE,mCAAmC;AACrC;;AAEA;;;EAGE,SAAS;AACX;;AAEA;EACE,WAAW;EACX,aAAa;EACb,8BAA8B;AAChC;;AAEA;EACE,YAAY;EACZ,kBAAkB;AACpB;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;EAClB,QAAQ;AACV;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,kBAAkB;EAClB,QAAQ;AACV;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,gBAAgB;EAChB,mBAAmB;AACrB;;AAEA;EACE,8BAA8B;AAChC;;AAEA;EACE,2BAA2B;AAC7B;;AAEA;EACE,4BAA4B;AAC9B;;AAEA;EACE,6BAA6B;AAC/B;;AAEA;EACE,iBAAiB;AACnB;;AAEA;EACE,8BAA8B;AAChC;;AAEA;EACE,UAAU;AACZ;;AAEA;EACE,QAAQ;AACV;;AAEA;EACE,mCAAmC;EACnC,wCAAwC;EACxC,YAAY;AACd;;AAEA;EACE,mCAAmC;AACrC;;AAEA;EACE,mCAAmC;AACrC;;AAEA;EACE,qBAAqB;EACrB,cAAc;AAChB",sourcesContent:[".lsp-popover {\n  /* jupyterlab Menu */\n  z-index: 10000;\n  padding: 4px 0px;\n  background: var(--jp-layout-color0);\n  color: var(--jp-ui-font-color1);\n  border: var(--jp-border-width) solid var(--jp-border-color1);\n  font-size: var(--jp-ui-font-size1);\n  box-shadow: var(--jp-elevation-z6);\n}\n\n.lsp-popover-content {\n  padding: 5px 10px;\n}\n\n.lsp-servers-title {\n  margin-bottom: 5px;\n}\n\n.lsp-servers-menu {\n  height: 350px;\n  overflow-y: auto;\n}\n\n.lsp-server-status,\n.lsp-missing-server,\n.lsp-documents-by-language {\n  margin-left: 20px;\n}\n\nh5 .lsp-language-server-name {\n  color: var(--jp-ui-font-color2);\n}\n\n.lsp-documents-by-language ul,\n.lsp-server-status ul {\n  margin: 0;\n  padding-left: 25px;\n}\n\n.lsp-servers-menu h5 {\n  font-weight: normal;\n  font-size: 100%;\n  white-space: nowrap;\n}\n\n.lsp-servers-lists {\n  margin-left: 5px;\n}\n\n.lsp-popover-status {\n  padding-top: 5px;\n  border-top: 1px solid var(--jp-border-color1);\n}\n\n.lsp-popover-status a {\n  color: var(--jp-content-link-color);\n}\n\n.lsp-servers-menu h3,\nh4,\nh5 {\n  margin: 0;\n}\n\n.lsp-documents-by-language li {\n  width: 100%;\n  display: flex;\n  justify-content: space-between;\n}\n\n.lsp-document-status {\n  float: right;\n  padding-left: 15px;\n}\n\n.lsp-document-status-icon {\n  margin-left: 5px;\n  position: relative;\n  top: 3px;\n}\n\n.lsp-collapsible-list h4 {\n  cursor: pointer;\n}\n\n.lsp-collapsible-list .lsp-caret-icon {\n  position: relative;\n  top: 3px;\n}\n\n.lsp-collapsible-list.lsp-collapsed div {\n  display: none;\n}\n\n.lsp-statusbar-item {\n  overflow: hidden;\n  white-space: nowrap;\n}\n\n.lsp-status-icon.ready svg g {\n  fill: var(--jp-success-color0);\n}\n\n.lsp-status-icon.preparing svg g {\n  fill: var(--jp-warn-color0);\n}\n\n.lsp-status-icon.error svg g {\n  fill: var(--jp-error-color0);\n}\n\n.lsp-status-icon.inactive svg g {\n  fill: var(--jp-layout-color3);\n}\n\n.lsp-status-message {\n  user-select: none;\n}\n\nbody[data-jp-theme-light='false'] .lsp-status-icon.ready svg g {\n  fill: var(--jp-success-color1);\n}\n\n.lsp-statusbar-item.jp-mod-clicked .jp-icon-selectable[fill] {\n  fill: #fff;\n}\n\n.jp-ToolbarButton .lsp-status-icon svg {\n  top: 5px;\n}\n\n.lsp-help-button {\n  background: var(--jp-layout-color2);\n  border: 1px solid var(--jp-brand-color0);\n  float: right;\n}\n\n.lsp-help-button:hover {\n  background: var(--jp-layout-color3);\n}\n\n.lsp-server-links-list a {\n  color: var(--jp-content-link-color);\n}\n\n.lsp-troubleshoot-section {\n  white-space: pre-wrap;\n  margin: 10px 0;\n}\n"],sourceRoot:""}]);const a=s},9538:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(7796),o=n.n(i),r=n(1051),s=n.n(r)()(o());s.push([e.id,".lsp-tooltip .jp-RenderedHTMLCommon {\n  /* Reduce the default padding from 20px to 0px */\n  padding-right: 0px;\n}\n\n.lsp-tooltip .jp-RenderedHTMLCommon > *:last-child {\n  /* Reduce the default margin */\n  margin-bottom: 0;\n}\n","",{version:3,sources:["webpack://./style/tooltip.css"],names:[],mappings:"AAAA;EACE,gDAAgD;EAChD,kBAAkB;AACpB;;AAEA;EACE,8BAA8B;EAC9B,gBAAgB;AAClB",sourcesContent:[".lsp-tooltip .jp-RenderedHTMLCommon {\n  /* Reduce the default padding from 20px to 0px */\n  padding-right: 0px;\n}\n\n.lsp-tooltip .jp-RenderedHTMLCommon > *:last-child {\n  /* Reduce the default margin */\n  margin-bottom: 0;\n}\n"],sourceRoot:""}]);const a=s},8996:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(7796),o=n.n(i),r=n(1051),s=n.n(r)()(o());s.push([e.id,":root {\n  /* highlight */\n  --jp-editor-mirror-lsp-highlight-background-color: color-mix(\n    in srgb,\n    var(--jp-layout-color3) 25%,\n    transparent\n  );\n  --jp-editor-mirror-lsp-highlight-border-color: var(--jp-layout-color3);\n  /* diagnostics */\n  --jp-editor-mirror-lsp-diagnostic-decoration-style: dashed;\n  --jp-editor-mirror-lsp-diagnostic-error-decoration-color: var(\n    --jp-error-color1\n  );\n  --jp-editor-mirror-lsp-diagnostic-warning-decoration-color: var(\n    --jp-warn-color1\n  );\n  --jp-editor-mirror-lsp-diagnostic-information-decoration-color: var(\n    --jp-info-color1\n  );\n  --jp-editor-mirror-lsp-diagnostic-hint-decoration-color: var(\n    --jp-success-color1\n  );\n  /* hover */\n  --jp-editor-mirror-lsp-hover-decoration-style: dotted;\n  --jp-editor-mirror-lsp-hover-decoration-color: var(--jp-brand-color1);\n  /* signature */\n  --jp-lsp-signature-mark-color: black;\n  --jp-lsp-signature-mark-background: yellow;\n}\n","",{version:3,sources:["webpack://./style/variables/base.css"],names:[],mappings:"AAAA;EACE,cAAc;EACd;;;;GAIC;EACD,sEAAsE;EACtE,gBAAgB;EAChB,0DAA0D;EAC1D;;GAEC;EACD;;GAEC;EACD;;GAEC;EACD;;GAEC;EACD,UAAU;EACV,qDAAqD;EACrD,qEAAqE;EACrE,cAAc;EACd,oCAAoC;EACpC,0CAA0C;AAC5C",sourcesContent:[":root {\n  /* highlight */\n  --jp-editor-mirror-lsp-highlight-background-color: color-mix(\n    in srgb,\n    var(--jp-layout-color3) 25%,\n    transparent\n  );\n  --jp-editor-mirror-lsp-highlight-border-color: var(--jp-layout-color3);\n  /* diagnostics */\n  --jp-editor-mirror-lsp-diagnostic-decoration-style: dashed;\n  --jp-editor-mirror-lsp-diagnostic-error-decoration-color: var(\n    --jp-error-color1\n  );\n  --jp-editor-mirror-lsp-diagnostic-warning-decoration-color: var(\n    --jp-warn-color1\n  );\n  --jp-editor-mirror-lsp-diagnostic-information-decoration-color: var(\n    --jp-info-color1\n  );\n  --jp-editor-mirror-lsp-diagnostic-hint-decoration-color: var(\n    --jp-success-color1\n  );\n  /* hover */\n  --jp-editor-mirror-lsp-hover-decoration-style: dotted;\n  --jp-editor-mirror-lsp-hover-decoration-color: var(--jp-brand-color1);\n  /* signature */\n  --jp-lsp-signature-mark-color: black;\n  --jp-lsp-signature-mark-background: yellow;\n}\n"],sourceRoot:""}]);const a=s},6801:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(7796),o=n.n(i),r=n(1051),s=n.n(r)()(o());s.push([e.id,".cm-s-abcdef {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(144, 199, 255, 0.2);\n}\n\n.cm-s-base16-dark {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\n}\n\n.cm-s-base16-light {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(186, 192, 161, 0.1);\n}\n\n.cm-s-default {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\n}\n\n.cm-s-hopscotch {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(207, 18, 255, 0.2);\n}\n\n.cm-s-material {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 255, 58, 0.2);\n}\n\n.cm-s-mbo {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\n}\n\n.cm-s-material {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\n}\n\n.cm-s-mdn-like {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\n}\n\n.cm-s-seti {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\n}\n\n.cm-s-solarized {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\n}\n\n.cm-s-the-matrix {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.1);\n}\n\n.cm-s-xq-light {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\n}\n\n.cm-s-zenburn {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\n}\n","",{version:3,sources:["webpack://./style/variables/cm-themes.css"],names:[],mappings:"AAAA;EACE,2EAA2E;AAC7E;;AAEA;EACE,2EAA2E;AAC7E;;AAEA;EACE,2EAA2E;AAC7E;;AAEA;EACE,yEAAyE;AAC3E;;AAEA;EACE,0EAA0E;AAC5E;;AAEA;EACE,yEAAyE;AAC3E;;AAEA;EACE,2EAA2E;AAC7E;;AAEA;EACE,2EAA2E;AAC7E;;AAEA;EACE,yEAAyE;AAC3E;;AAEA;EACE,2EAA2E;AAC7E;;AAEA;EACE,yEAAyE;AAC3E;;AAEA;EACE,2EAA2E;AAC7E;;AAEA;EACE,yEAAyE;AAC3E;;AAEA;EACE,2EAA2E;AAC7E",sourcesContent:[".cm-s-abcdef {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(144, 199, 255, 0.2);\n}\n\n.cm-s-base16-dark {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\n}\n\n.cm-s-base16-light {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(186, 192, 161, 0.1);\n}\n\n.cm-s-default {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\n}\n\n.cm-s-hopscotch {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(207, 18, 255, 0.2);\n}\n\n.cm-s-material {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 255, 58, 0.2);\n}\n\n.cm-s-mbo {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\n}\n\n.cm-s-material {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\n}\n\n.cm-s-mdn-like {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\n}\n\n.cm-s-seti {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\n}\n\n.cm-s-solarized {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\n}\n\n.cm-s-the-matrix {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.1);\n}\n\n.cm-s-xq-light {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\n}\n\n.cm-s-zenburn {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(239, 231, 171, 0.2);\n}\n"],sourceRoot:""}]);const a=s},2361:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(7796),o=n.n(i),r=n(1051),s=n.n(r)()(o());s.push([e.id,"body[data-jp-theme-light='false'] .cm-s-jupyter {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(151, 173, 255, 0.3);\n}\n\nbody[data-jp-theme-light='false'] {\n  --jp-lsp-signature-mark-color: white;\n  --jp-lsp-signature-mark-background: #607e01;\n}\n","",{version:3,sources:["webpack://./style/variables/jupyterlab-dark.css"],names:[],mappings:"AAAA;EACE,2EAA2E;AAC7E;;AAEA;EACE,oCAAoC;EACpC,2CAA2C;AAC7C",sourcesContent:["body[data-jp-theme-light='false'] .cm-s-jupyter {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(151, 173, 255, 0.3);\n}\n\nbody[data-jp-theme-light='false'] {\n  --jp-lsp-signature-mark-color: white;\n  --jp-lsp-signature-mark-background: #607e01;\n}\n"],sourceRoot:""}]);const a=s},6143:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(7796),o=n.n(i),r=n(1051),s=n.n(r)()(o());s.push([e.id,"body[data-jp-theme-light='true'] .cm-s-jupyter {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\n}\n","",{version:3,sources:["webpack://./style/variables/jupyterlab-light.css"],names:[],mappings:"AAAA;EACE,yEAAyE;AAC3E",sourcesContent:["body[data-jp-theme-light='true'] .cm-s-jupyter {\n  --jp-editor-mirror-lsp-highlight-background-color: rgba(18, 69, 255, 0.1);\n}\n"],sourceRoot:""}]);const a=s},4661:(e,t,n)=>{n.r(t),n.d(t,{ILSPCodeOverridesManager:()=>d,ILSPLogConsole:()=>s,LSPExtension:()=>ni,PLUGIN_ID:()=>r,RegExpForeignCodeExtractor:()=>c,SCHEMA:()=>i,default:()=>ri});var i={};n.r(i);var o=n(7930);const r="@jupyter-lsp/jupyterlab-lsp",s=new o.Token(r+":ILSPLogConsole");var a=n(1828);function l(e,t,n){let i=e.exec(t);if(null==i)return console.warn(`No capture group found for ${e} in ${t}`),-1;let o=0,r=i[0];for(let e of i.slice(1)){if(void 0===e)continue;if(e===n){o+=r.indexOf(e);break}let t=r.indexOf(e)+e.length;r=r.slice(t),o+=t}return o}class c{constructor(e){this.cellType=["code"],this.language=e.language,this.options=e,this.globalExpression=new RegExp(e.pattern,"g"),this.testExpression=new RegExp(e.pattern,"g"),this.expression=new RegExp(e.pattern),this.standalone=this.options.isStandalone,this.fileExtension=this.options.fileExtension}hasForeignCode(e){const t=this.testExpression.test(e);return this.testExpression.lastIndex=0,t}extractForeignCode(e){const t=e.split("\n"),n=new Array;let i,o,r=this.globalExpression.lastIndex,s=this.globalExpression.exec(e),c=!1;if(void 0!==this.options.foreignReplacer)o=this.options.foreignReplacer,c=!0;else if(void 0!==this.options.foreignCaptureGroups)o="$"+this.options.foreignCaptureGroups.join("$"),c=!0;else{if(!this.options.extractToForeign)return console.warn("Foreign replacer not defined for extractor: {this.expression} - this is deprecated; use 'foreignReplacer' to define it"),[];o=this.options.extractToForeign}for(;null!=s;){let d=s[0],u=null,p=d.replace(this.expression,o),g="";void 0!==this.options.extractArguments&&(g=d.replace(this.expression,this.options.extractArguments),u=(0,a.positionAtOffset)(g.length,g.split("\n")));let h=this.globalExpression.lastIndex;i=this.options.keepInHost||null==this.options.keepInHost?e.substring(r,h):r===s.index?"":e.substring(r,s.index)+"\n";let m=p;c&&(m=d.replace(this.expression,"$"+Math.min(...this.options.foreignCaptureGroups)));const f=l(this.expression,d,m);let A=s.index+f,v=(0,a.positionAtOffset)(A,t),E=(0,a.positionAtOffset)(A+p.length,t);n.push({hostCode:i,foreignCode:g+p,range:{start:v,end:E},virtualShift:u}),r=this.globalExpression.lastIndex,s=this.globalExpression.exec(e)}if(r!==e.length){let t=e.substring(r,e.length);n.push({hostCode:t,foreignCode:null,range:null,virtualShift:null})}return n}}const d=new o.Token(r+":ILSPCodeOverridesManager");var u=n(2791),p=n(8429),g=n(1589),h=n(7722),m=n(3680),f=n(2160),A=n(6759),v=n(5057),E=n(6062),C=n.n(E),b=n(4036),w=n.n(b),y=n(6793),_=n.n(y),x=n(7892),k=n.n(x),S=n(1173),j=n.n(S),M=n(2464),D=n.n(M),B=n(4599),R={};R.styleTagTransform=D(),R.setAttributes=k(),R.insert=_().bind(null,"head"),R.domAPI=w(),R.insertStyleElement=j(),C()(B.Z,R),B.Z&&B.Z.locals&&B.Z.locals;var T=n(6486);class I extends Map{constructor(e){super(e.map((e=>[new RegExp(e.pattern),e.replacement])))}_overrideFor(e){for(let[t,n]of this)if(e.match(t))return e.replace(t,n);return null}}class P extends I{constructor(e){super(e),this.overrides=e}get reverse(){return this.type(this.overrides.filter((e=>null!=e.reverse)).map((e=>e.reverse)))}type(e){return new P(e)}overrideFor(e){return super._overrideFor(e)}replaceAll(e,t=this){let n=new Array,i=new Array;for(let o=0;o<e.length;o++){let r=e[o],s=t.overrideFor(r);n.push(null==s?r:s),i.push(null!=s)}return{lines:n,skipInspect:i}}reverseReplaceAll(e){return this.replaceAll(e,this.reverse).lines}}class L extends a.VirtualDocument{constructor(e){super(e);const t=this.language in e.overridesRegistry?e.overridesRegistry[this.language]:null;this.cellMagicsOverrides=new P(t?t.cell:[]),this.lineMagicsOverrides=new P(t?t.line:[]),this.chooseForeignDocument=this._chooseForeignDocument}decodeCodeBlock(e){const t=this.cellMagicsOverrides.reverse.overrideFor(e);return null!=t?t:this.lineMagicsOverrides.reverseReplaceAll(e.split("\n")).join("\n")}prepareCodeBlock(e,t={line:0,column:0}){let n,i,{cellCodeKept:o,foreignDocumentsMap:r}=this.extractForeignCode(e,t);const s=o,a=this.cellMagicsOverrides.overrideFor(s);if(null!=a)n=a.split("\n"),i=n.map((e=>[this.idPath]));else{let e=this.lineMagicsOverrides.replaceAll(s.split("\n"));n=e.lines,i=e.skipInspect.map((e=>e?[this.idPath]:[]))}return{lines:n,foreignDocumentsMap:r,skipInspect:i}}appendCodeBlock(e,t={line:0,column:0},n){let i=e.value,o=e.ceEditor;if(this.isDisposed)return void console.warn("Cannot append code block: document disposed");let r=i.split("\n"),{lines:s,foreignDocumentsMap:a,skipInspect:l}=this.prepareCodeBlock(e,t);for(let e=0;e<s.length;e++)this.virtualLines.set(this.lastVirtualLine+e,{skipInspect:l[e],editor:o,sourceLine:this.lastSourceLine+e});for(let e=0;e<r.length;e++)this.sourceLines.set(this.lastSourceLine+e,{editorLine:e,editorShift:{line:t.line-((null==n?void 0:n.line)||0),column:0===e?t.column-((null==n?void 0:n.column)||0):0},editor:o,foreignDocumentsMap:a,virtualLine:this.lastVirtualLine+e});this.lastVirtualLine+=s.length,this.lineBlocks.push(s.join("\n")+"\n");for(let e=0;e<this.blankLinesBetweenCells;e++)this.virtualLines.set(this.lastVirtualLine+e,{skipInspect:[this.idPath],editor:o,sourceLine:null});this.lastVirtualLine+=this.blankLinesBetweenCells,this.lastSourceLine+=r.length}closeExpiredDocuments(){const e=new Set;for(const t of this.sourceLines.values())for(const n of t.foreignDocumentsMap.values())e.add(n.virtualDocument);const t=new Map;for(const[e,n]of this.foreignDocuments.entries()){const i=t.get(n);void 0!==i&&t.set(n,[...i,e]),t.set(n,[e])}const n=new Set(t.keys()),i=new Set([...n].filter((t=>!e.has(t))));for(let e of i.values())if(e.remainingLifetime-=1,e.remainingLifetime<=0){e.dispose();const n=t.get(e);for(const e of n)this.foreignDocuments.delete(e)}}transformVirtualToRoot(e){let t=this.virtualLines.get(e.line).editor,n=this.transformVirtualToEditor(e);return this.root.transformFromEditorToRoot(t,n)}getForeignDocuments(e){let t=new Set;for(let n of this.sourceLines.values())n.editor===e&&t.add(n.foreignDocumentsMap);return[...t.values()]}_chooseForeignDocument(e){let t,n=this.foreignDocuments.has(e.language);if(!e.standalone&&n)t=this.foreignDocuments.get(e.language);else{let n=this.unusedStandaloneDocuments.get(e.language);e.standalone&&n.length>0?(t=n.pop(),this.unusedDocuments.delete(t)):t=this.openForeign(e.language,e.standalone,e.fileExtension)}return t}}class O extends T.FileEditorAdapter{constructor(e,t){super(e,t),this.editorWidget=e,this.options=t}createVirtualDocument(){return new L({language:this.language,foreignCodeExtractors:this.options.foreignCodeExtractorsManager,path:this.documentPath,fileExtension:this.languageFileExtension,standalone:!0,hasLspSupportedFile:!0,overridesRegistry:this.options.codeOverridesManager.registry})}}const F={id:"@jupyter-lsp/fileeditor-adapter",description:"Adds language server capability to the notebooks.",requires:[T.IEditorTracker,a.ILSPDocumentConnectionManager,a.ILSPFeatureManager,a.ILSPCodeExtractorsManager,d],activate:function(e,t,n,i,o,r){t.widgetAdded.connect((async(t,s)=>{const a=new O(s,{connectionManager:n,featureManager:i,foreignCodeExtractorsManager:o,docRegistry:e.docRegistry,codeOverridesManager:r});n.registerAdapter(s.context.path,a)}))},autoStart:!0};var N=n(829);class z extends N.NotebookAdapter{constructor(e,t){super(e,t),this.editorWidget=e,this.options=t,this._blockUpdates=!1}createVirtualDocument(){return new L({language:this.language,foreignCodeExtractors:this.options.foreignCodeExtractorsManager,path:this.documentPath,fileExtension:this.languageFileExtension,standalone:!1,hasLspSupportedFile:!1,overridesRegistry:this.options.codeOverridesManager.registry})}async onForeignDocumentOpened(e,t){try{this._blockUpdates=!0,await super.onForeignDocumentOpened(e,t)}finally{this._blockUpdates=!1}}updateDocuments(){return this._blockUpdates?Promise.resolve():super.updateDocuments()}}const H={id:"@jupyter-lsp/notebook-adapter",description:"Adds language server capability to the notebooks.",requires:[N.INotebookTracker,a.ILSPDocumentConnectionManager,a.ILSPFeatureManager,a.ILSPCodeExtractorsManager,d],activate:function(e,t,n,i,o,r){t.widgetAdded.connect((async(e,t)=>{const s=new z(t,{connectionManager:n,featureManager:i,foreignCodeExtractorsManager:o,codeOverridesManager:r});n.registerAdapter(t.context.path,s)}))},autoStart:!0};var V=n(7119),q=n(6029),$=n.n(q),W=n(4929),U={};function G(e,t){return $().createElement("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"lsp-external-link"},t)}U.styleTagTransform=D(),U.setAttributes=k(),U.insert=_().bind(null,"head"),U.domAPI=w(),U.insertStyleElement=j(),C()(W.Z,U),W.Z&&W.Z.locals&&W.Z.locals;const Z=$().createElement("div",null,$().createElement("p",null,"It appears that the required Jupyter server extension (",$().createElement("code",null,"jupyter-lsp"),") is not installed (or not enabled) in this environment."),$().createElement("h3",null,"What are the likely reasons?"),$().createElement("ul",null,$().createElement("li",null,"It might be that you just installed it and need to restart JupyterLab to make it available on startup."),$().createElement("li",null,"Alternatively, you may be using an older ",$().createElement("code",null,"notebook")," server instead of the new ",$().createElement("code",null,"jupyter_server"),"; please refer to the"," ",G("https://jupyter-server.readthedocs.io/en/latest/operators/migrate-from-nbserver.html","migration guide")," or if you are a JupyterHub user please ensure that you start the JupyterLab using"," ",$().createElement("code",null,"jupyter_server")," and not the old ",$().createElement("code",null,"notebook"),", as documented in"," ",G("https://github.com/jupyterhub/jupyterhub/pull/3329/files","this pull request"),"."),$().createElement("li",null,"There may be schema errors or language server errors preventing the extension from loading - please check the logs of JupyterLab (in the console where you execute ",$().createElement("code",null,"jupyter lab"))),$().createElement("h3",null,"How do I check if the extension is installed?"),$().createElement("p",null,"Please ensure that ",$().createElement("code",null,"jupyter server extension list")," includes jupyter-lsp and that it is enabled. If it is enabled please try to restart JupyterLab. If the server extension is installed but not enabled and all other suggestions listed above failed try the following:",$().createElement("code",null,"jupyter server extension enable --user --py jupyter_lsp"))),J=new v.LabIcon({name:"lsp:codeWarning",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">\n  <g class="jp-icon3 jp-icon-selectable" fill="#616161" shape-rendering="geometricPrecision">\n    <path d="M6.59 3.41L2 8l4.59 4.6L8 11.18 4.82 8 8 4.82 6.59 3.41m5.82 0L11 4.82 14.18 8 11 11.18l1.41 1.42L17 8l-4.59-4.59M16.95 12.05L10.9 22.5H23m-6.05-8.25l4.141 7.15h-8.283m3.592-4.95v2.2h1.1v-2.2m-1.1 3.3v1.1h1.1v-1.1"/>\n  </g>\n</svg>\n'}),K=new v.LabIcon({name:"lsp:codeClock",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">\n  <g class="jp-icon3 jp-icon-selectable" fill="#616161" shape-rendering="geometricPrecision">\n    <path d="M6.59 3.41L2 8l4.59 4.6L8 11.18 4.82 8 8 4.82 6.59 3.41m5.82 0L11 4.82 14.18 8 11 11.18l1.41 1.42L17 8l-4.59-4.59M18.093 21.608a3.998 3.998 0 004.015-4.015 3.998 3.998 0 00-4.015-4.016 3.998 3.998 0 00-4.016 4.016 3.998 3.998 0 004.016 4.015m0-8.923c2.676 0 4.907 2.23 4.907 4.908 0 2.676-2.23 4.907-4.907 4.907s-4.908-2.23-4.908-4.907 2.23-4.908 4.908-4.908m2.498 5.89l-.348.624-2.588-1.428v-2.632h.75v2.141z" />\n  </g>\n</svg>\n'}),Y=new v.LabIcon({name:"lsp:codeCheck",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">\n  <g class="jp-icon3 jp-icon-selectable" fill="#616161" shape-rendering="geometricPrecision">\n    <path d="M6.59,3.41L2,8L6.59,12.6L8,11.18L4.82,8L8,4.82L6.59,3.41M12.41,3.41L11,4.82L14.18,8L11,11.18L12.41,12.6L17,8L12.41,3.41M21.59,11.59L13.5,19.68L9.83,16L8.42,17.41L13.5,22.5L23,13L21.59,11.59Z" />\n  </g>\n</svg>\n'});function X(e){let{document:t,adapter:n}=e,i=null;if(n.hasMultipleEditors){let e=t.virtualLines.get(0);e?i=e.editor:console.warn("Could not get first line of ",t)}let o=function(e,t,n,i=!0){return n||(n=A.nullTranslator.load("")),e.ancestry.map((e=>{if(!e.parent){let t=e.path;!e.hasLspSupportedFile&&e.fileExtension&&t.endsWith(e.fileExtension)&&(t=t.slice(0,-e.fileExtension.length-1));const n=t;if(i){let e=t.split("/");e.length>2&&(t=e[0]+"/.../"+e[e.length-1])}return $().createElement("span",{key:e.uri,title:n},t)}const o=e.virtualLines;if(!o.size)return $().createElement("span",{key:e.uri},"Empty document");try{if(t.hasMultipleEditors){let i=o.get(0),r=o.get(e.lastVirtualLine-1),s=t.getEditorIndex(i.editor),a=t.getEditorIndex(r.editor),l=s===a?n.__("cell %1",s+1):n.__("cells: %1-%2",s+1,a+1);return $().createElement("span",{key:e.uri},e.language," (",l,")")}}catch(e){console.warn("LSP: could not display document cell location",e)}return $().createElement("span",{key:e.uri},e.language)}))}(t,n,e.trans);return $().createElement("div",{className:"lsp-document-locator",onClick:()=>i?async function(e){e&&(await e.reveal(),e.getEditor().focus())}(i):null},o)}function Q(e){var t;return $().createElement("ul",{className:"lsp-server-links-list"},Object.entries((null===(t=e.specification)||void 0===t?void 0:t.urls)||{}).map((([t,n])=>$().createElement("li",{key:e.specification.serverId+"-url-"+t},t,":"," ",$().createElement("a",{href:n,target:"_blank",rel:"noreferrer"},n)))))}var ee=V.Dialog.okButton;function te(e){let t=e.server.spec.languages.map(((e,t)=>$().createElement("li",{key:t},e)));return $().createElement("div",{className:"lsp-server-status"},$().createElement("h5",null,e.server.spec.display_name),$().createElement("ul",null,t))}class ne extends $().Component{constructor(e){super(e),this.handleClick=()=>{this.setState((e=>({isCollapsed:!e.isCollapsed})))},this.state={isCollapsed:e.startCollapsed||!1}}render(){const e=this.state.isCollapsed?v.caretDownIcon:v.caretUpIcon;return $().createElement("div",{className:"lsp-collapsible-list "+(this.state.isCollapsed?"lsp-collapsed":"")},$().createElement("h4",{onClick:this.handleClick},$().createElement(e.react,{tag:"span",className:"lsp-caret-icon"}),this.props.title,": ",this.props.list.length),$().createElement("div",null,this.props.list))}}class ie extends $().Component{render(){const e=this.props.specs,t=this.props.trans;return $().createElement("div",null,$().createElement("h3",null,e.display_name),$().createElement("div",null,$().createElement(Q,{specification:e}),$().createElement("h4",null,t.__("Troubleshooting")),$().createElement("p",{className:"lsp-troubleshoot-section"},e.troubleshoot?e.troubleshoot:t.__("In case of issues with installation feel welcome to ask a question on GitHub.")),$().createElement("h4",null,t.__("Installation")),$().createElement("ul",null,(null==e?void 0:e.install)?Object.entries((null==e?void 0:e.install)||{}).map((([e,t])=>$().createElement("li",{key:this.props.serverId+"-install-"+e},e,": ",$().createElement("code",null,t)))):t.__("No installation instructions were provided with this specification."))))}}class oe extends $().Component{constructor(){super(...arguments),this.handleClick=()=>{const e=this.props.trans;(0,V.showDialog)({title:e.__("No language server for %1 detected",this.props.language),body:$().createElement("div",null,this.props.servers.size?$().createElement("div",null,$().createElement("p",null,e._n("There is %1 language server you can easily install that supports %2.","There are %1 language servers you can easily install that supports %2.",this.props.servers.size,this.props.language)),[...this.props.servers.entries()].map((([t,n])=>$().createElement(ie,{specs:n,serverId:t,key:t,trans:e})))):$().createElement("div",null,$().createElement("p",null,e.__("We do not have an auto-detection ready for a language servers supporting %1 yet.",this.props.language)),$().createElement("p",null,e.__("You may contribute a specification for auto-detection as described in our ")," ",$().createElement("a",{href:"https://jupyterlab-lsp.readthedocs.io/en/latest/Contributing.html#specs"},e.__("documentation"))))),buttons:[ee()]}).catch(console.warn)}}render(){return $().createElement("button",{type:"button",className:"jp-Button lsp-help-button",onClick:this.handleClick},"?")}}class re extends V.VDomRenderer{constructor(e){super(e),this.addClass("lsp-popover")}render(){var e;if(!(null===(e=this.model)||void 0===e?void 0:e.connectionManager))return null;const t=this.model.serversAvailableNotInUse.map(((e,t)=>$().createElement(te,{key:t,server:e})));let n=new Array,i=-1;for(let[e,t]of this.model.documentsByServer.entries()){i+=1;let o=new Array;for(let[n,r]of t){let t=r.map(((e,t)=>{let n=this.model.connectionManager.connections.get(e.uri),i="";i=(null==n?void 0:n.isInitialized)?"initialized":(null==n?void 0:n.isConnected)?"connected":"not connected";const o="initialized"===i?v.circleIcon:v.circleEmptyIcon;return $().createElement("li",{key:t},$().createElement(X,{document:e,adapter:this.model.adapter}),$().createElement("span",{className:"lsp-document-status"},this.model.trans.__(i),$().createElement(o.react,{tag:"span",className:"lsp-document-status-icon",elementSize:"small"})))}));o.push($().createElement("div",{key:i,className:"lsp-documents-by-language"},$().createElement("h5",null,n," ",$().createElement("span",{className:"lsp-language-server-name"},"(",e.spec.display_name,")")),$().createElement("ul",null,t)))}n.push($().createElement("div",{key:i},o))}const o=this.model.missingLanguages.map(((e,t)=>{const n=this.model.languageServerManager.getMatchingSpecs({language:e});return $().createElement("div",{key:t,className:"lsp-missing-server"},e,n.size?$().createElement(oe,{language:e,servers:n,trans:this.model.trans}):"")})),r=this.model.trans;return $().createElement("div",{className:"lsp-popover-content"},$().createElement("div",{className:"lsp-servers-menu"},$().createElement("h3",{className:"lsp-servers-title"},r.__("LSP servers")),$().createElement("div",{className:"lsp-servers-lists"},t.length?$().createElement(ne,{key:"available",title:r.__("Available"),list:t,startCollapsed:!0}):"",n.length?$().createElement(ne,{key:"running",title:r.__("Running"),list:n}):"",o.length?$().createElement(ne,{key:"missing",title:r.__("Missing"),list:o}):"")),$().createElement("div",{className:"lsp-popover-status"},r.__("Documentation:")," ",$().createElement("a",{href:"https://jupyterlab-lsp.readthedocs.io/en/latest/Language%20Servers.html",target:"_blank",rel:"noreferrer"},r.__("Language Servers"))))}}class se extends V.VDomRenderer{constructor(e=!0,t,n){super(new se.Model(t,n)),this.displayText=e,this._popup=null,this.handleClick=()=>{this._popup&&this._popup.dispose(),"noServerExtension"==this.model.status.status?(0,V.showDialog)({title:this.trans.__("LSP server extension not found"),body:Z,buttons:[ee()]}).catch(console.warn):this._popup=(0,f.showPopup)({body:new re(this.model),anchor:this,align:"left",hasDynamicSize:!0})},this.addClass("jp-mod-highlighted"),this.addClass("lsp-statusbar-item"),this.trans=n,this.title.caption=this.trans.__("LSP status")}render(){const{model:e}=this;return null==e?null:$().createElement(f.GroupItem,{spacing:this.displayText?2:0,title:e.longMessage,onClick:this.handleClick,className:"lsp-status-group"},$().createElement(e.statusIcon.react,{top:"2px",stylesheet:"statusBar",title:this.trans.__("LSP Code Intelligence")}),this.displayText?$().createElement(f.TextItem,{className:"lsp-status-message",source:e.shortMessage}):$().createElement($().Fragment,null))}}class ae{constructor(e){this.options=e}createItem(e=!0){const t=new se(e,this.options.shell,this.options.translatorBundle);return t.model.languageServerManager=this.options.languageServerManager,t.model.connectionManager=this.options.connectionManager,t}createNew(e,t){const n=this.createItem(!1);return n.addClass("jp-ToolbarButton"),e.toolbar.insertAfter("spacer","LSPStatus",n),n}}const le={noServerExtension:"error",waiting:"inactive",initialized:"ready",initializing:"preparing",initializedButSomeMissing:"ready",connecting:"preparing"},ce={noServerExtension:J,waiting:K,initialized:Y,initializing:K,initializedButSomeMissing:J,connecting:K};!function(e){class t extends V.VDomModel{constructor(e,t){super(),this._shell=e,this._onChange=()=>{this.stateChanged.emit(void 0)},this.trans=t,this._shortMessageByStatus={noServerExtension:t.__("Server extension missing"),waiting:t.__("Waiting"),initialized:t.__("Fully initialized"),initializedButSomeMissing:t.__("Initialized (additional servers needed)"),initializing:t.__("Initializing"),connecting:t.__("Connecting")}}get availableServers(){return this.languageServerManager.sessions}get supportedLanguages(){const e=new Set;for(let t of this.availableServers.values())for(let n of t.spec.languages)e.add(n.toLocaleLowerCase());return e}_isServerRunning(e,t){for(const t of this.detectedLanguages){const n=this.languageServerManager.getMatchingServers({language:t});if(n.length&&n[0]===e)return!0}return!1}get documentsByServer(){var e;let t=new Map;if(!(null===(e=this.adapter)||void 0===e?void 0:e.virtualDocument))return t;let n=this.adapter.virtualDocument,i=(0,a.collectDocuments)(n);for(let e of i.values()){let n=e.language.toLocaleLowerCase(),i=this._connectionManager.languageServerManager.getMatchingServers({language:e.language});if(0===i.length)continue;let o=this.languageServerManager.sessions.get(i[0]);t.has(o)||t.set(o,new Map);let r=t.get(o);r.has(n)||r.set(n,new Array),r.get(n).push(e)}return t}get serversAvailableNotInUse(){return[...this.availableServers.entries()].filter((([e,t])=>!this._isServerRunning(e,t))).map((([e,t])=>t))}get detectedLanguages(){var e;return(null===(e=this.adapter)||void 0===e?void 0:e.virtualDocument)?function(e){let t=(0,a.collectDocuments)(e);return new Set([...t].map((e=>e.language.toLocaleLowerCase())))}(this.adapter.virtualDocument):new Set}get missingLanguages(){return[...this.detectedLanguages].filter((e=>!this.supportedLanguages.has(e.toLocaleLowerCase())))}get status(){var e;let t;if(null===(e=this.adapter)||void 0===e?void 0:e.virtualDocument){let e=this.adapter.virtualDocument;const n=this._connectionManager.documents,i=(0,a.collectDocuments)(e);t=new Map([...n].filter((([e,t])=>i.has(t))))}else t=new Map;let n=new Set,i=new Set,o=new Set,r=new Set,s=new Set;t.forEach(((e,t)=>{let a=this._connectionManager.connections.get(t);0!==this._connectionManager.languageServerManager.getMatchingServers({language:e.language}).length&&s.add(e),a?(r.add(e),a.isConnected&&n.add(e),a.isInitialized&&i.add(e)):o.add(e)}));let l,c=new Array;return this._connectionManager.connections.forEach(((e,t)=>{e.isConnected&&c.push(e)})),l=404===this.languageServerManager.statusCode?"noServerExtension":0===t.size?"waiting":i.size===t.size?"initialized":i.size===r.size&&t.size>s.size?"initializedButSomeMissing":n.size===r.size?"initializing":"connecting",{openConnections:c,connectedDocuments:n,initializedDocuments:i,detectedDocuments:new Set([...t.values()]),status:l}}get statusIcon(){return this.adapter?ce[this.status.status].bindprops({className:"lsp-status-icon "+le[this.status.status]}):v.stopIcon}get shortMessage(){return this.adapter?this._shortMessageByStatus[this.status.status]:this.trans.__("Not initialized")}get longMessage(){if(!this.adapter)return this.trans.__("not initialized");let e=this.status,t="";if("waiting"===e.status)t=this.trans.__("Waiting for documents initialization...");else if("initialized"===e.status)t=this.trans._n("Fully connected & initialized (%2 virtual document)","Fully connected & initialized (%2 virtual document)",e.detectedDocuments.size,e.detectedDocuments.size);else if("initializing"===e.status){const n=new Set(e.detectedDocuments);for(let t of e.initializedDocuments.values())n.delete(t);t=this.trans._np("pluralized","Fully connected, but %2/%3 virtual document stuck uninitialized: %4","Fully connected, but %2/%3 virtual documents stuck uninitialized: %4",e.detectedDocuments.size,n.size,e.detectedDocuments.size,[...n].map((e=>e.idPath)).join(", "))}else{const n=new Set(e.detectedDocuments);for(let t of e.connectedDocuments.values())n.delete(t);t=this.trans._np("pluralized","%2/%3 virtual document connected (%4 connections; waiting for: %5)","%2/%3 virtual documents connected (%4 connections; waiting for: %5)",e.detectedDocuments.size,e.connectedDocuments.size,e.detectedDocuments.size,e.openConnections.length,[...n].map((e=>e.idPath)).join(", "))}return t}get adapter(){const e=[...this.connectionManager.adapters.values()].find((e=>e.widget==this._shell.currentWidget));return null!=e?e:null}get connectionManager(){return this._connectionManager}set connectionManager(e){null!=this._connectionManager&&(this._connectionManager.connected.disconnect(this._onChange),this._connectionManager.initialized.connect(this._onChange),this._connectionManager.disconnected.disconnect(this._onChange),this._connectionManager.closed.disconnect(this._onChange),this._connectionManager.documentsChanged.disconnect(this._onChange)),null!=e&&(e.connected.connect(this._onChange),e.initialized.connect(this._onChange),e.disconnected.connect(this._onChange),e.closed.connect(this._onChange),e.documentsChanged.connect(this._onChange)),this._connectionManager=e}}e.Model=t}(se||(se={}));var de,ue,pe,ge,he,me,fe,Ae,ve=n(904),Ee=n(9036),Ce=n(4901);class be{constructor(e){this.connectionManager=e.connectionManager}}class we{constructor(e,t){this.settingRegistry=e,this._ready=new o.PromiseDelegate,this.changed=new Ce.Signal(this),t in e.plugins?e.load(t).then((e=>{this.settings=e,this._ready.resolve(void 0),this.changed.emit(),e.changed.connect((()=>{this.settings=e,this.changed.emit()}))})).catch(console.warn):this._ready.reject(`${t} settings schema could not be found and was not loaded`)}get ready(){return this._ready.promise}get composite(){return this.settings.composite}set(e,t){this.settings.set(e,t).catch(console.warn)}}!function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(de||(de={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(ue||(ue={})),function(e){e[e.Deprecated=1]="Deprecated"}(pe||(pe={})),function(e){e[e.Text=1]="Text",e[e.Method=2]="Method",e[e.Function=3]="Function",e[e.Constructor=4]="Constructor",e[e.Field=5]="Field",e[e.Variable=6]="Variable",e[e.Class=7]="Class",e[e.Interface=8]="Interface",e[e.Module=9]="Module",e[e.Property=10]="Property",e[e.Unit=11]="Unit",e[e.Value=12]="Value",e[e.Enum=13]="Enum",e[e.Keyword=14]="Keyword",e[e.Snippet=15]="Snippet",e[e.Color=16]="Color",e[e.File=17]="File",e[e.Reference=18]="Reference",e[e.Folder=19]="Folder",e[e.EnumMember=20]="EnumMember",e[e.Constant=21]="Constant",e[e.Struct=22]="Struct",e[e.Event=23]="Event",e[e.Operator=24]="Operator",e[e.TypeParameter=25]="TypeParameter"}(ge||(ge={})),function(e){e[e.Text=1]="Text",e[e.Read=2]="Read",e[e.Write=3]="Write"}(he||(he={})),function(e){e[e.Invoked=1]="Invoked",e[e.TriggerCharacter=2]="TriggerCharacter",e[e.TriggerForIncompleteCompletions=3]="TriggerForIncompleteCompletions"}(me||(me={})),function(e){e[e.AutoInvoked=9999]="AutoInvoked"}(fe||(fe={})),function(e){e.abap="ABAP",e.bat="Windows Bat",e.bibtex="BibTeX",e.clojure="Clojure",e.coffeescript="Coffeescript",e.c="C",e.cpp="C++",e.csharp="C#",e.css="CSS",e.diff="Diff",e.dart="Dart",e.dockerfile="Dockerfile",e.elixir="Elixir",e.erlang="Erlang",e.fsharp="F#",e["git-commit"]="Git (commit)",e["git-rebase"]="Git (rebase)",e.go="Go",e.groovy="Groovy",e.handlebars="Handlebars",e.html="HTML",e.ini="Ini",e.java="Java",e.javascript="JavaScript",e.javascriptreact="JavaScript React",e.json="JSON",e.latex="LaTeX",e.less="Less",e.lua="Lua",e.makefile="Makefile",e.markdown="Markdown",e["objective-c"]="Objective-C",e["objective-cpp"]="Objective-C++",e.perl="Perl",e.perl6="Perl 6",e.php="PHP",e.powershell="Powershell",e.jade="Pug",e.python="Python",e.r="R",e.razor="Razor (cshtml)",e.ruby="Ruby",e.rust="Rust",e.scss="SCSS (syntax using curly brackets)",e.sass="SCSS (indented syntax)",e.scala="Scala",e.shaderlab="ShaderLab",e.shellscript="Shell Script (Bash)",e.sql="SQL",e.swift="Swift",e.typescript="TypeScript",e.typescriptreact="TypeScript React",e.tex="TeX",e.vb="Visual Basic",e.xml="XML",e.xsl="XSL",e.yaml="YAML"}(Ae||(Ae={}));class ye{static lsp_to_cm(e){return{line:e.line,ch:e.character}}static cm_to_lsp(e){return{line:e.line,character:e.ch}}static lsp_to_ce(e){return{line:e.line,column:e.character}}static cm_to_ce(e){return{line:e.line,column:e.ch}}static ce_to_cm(e){return{line:e.line,ch:e.column}}}function _e(e,t){let n=t;if(!e.virtualDocument)throw Error("Virtual document of adapter disposed!");if(e.virtualDocument.root!==e.virtualDocument)throw Error("Virtual document on adapter must be the root document");return e.virtualDocument.documentAtSourcePosition(n)}function xe(e,t){let n=t;if(!e.virtualDocument)throw Error("Virtual document of adapter disposed!");if(e.virtualDocument.root!==e.virtualDocument)throw Error("Virtual document on adapter must be the root document");return e.virtualDocument.getEditorAtSourceLine(n)}function ke(e,t){let n=t;if(!e.virtualDocument)throw Error("Virtual document of adapter disposed!");if(e.virtualDocument.root!==e.virtualDocument)throw Error("Virtual document on adapter must be the root document");return e.virtualDocument.virtualPositionAtDocument(n)}function Se(e,t){let n=t;if(!e.virtualDocument)throw Error("Virtual document of adapter disposed!");if(e.virtualDocument.root!==e.virtualDocument)throw Error("Virtual document on adapter must be the root document");return e.virtualDocument.transformSourceToEditor(n)}function je(e,t,n){if(!e.virtualDocument)throw Error("Virtual document of adapter disposed!");return e.virtualDocument.transformFromEditorToRoot(t,n)}function Me(e,t,n,i){let o=ye.lsp_to_cm(t.start),r=ye.lsp_to_cm(t.end);const s=L.prototype.transformVirtualToRoot.call(i,o);if(!s)throw Error("Could not determine position in root");if(null==n){const t=xe(e,s).getEditor();if(!t)throw Error("Editor could not be accessed");n=t}const a=_e(e,s);return{start:a.transformVirtualToEditor(o),end:a.transformVirtualToEditor(r),editor:n}}class De extends ve.ContextCompleterProvider{constructor(e){super(),this.options=e,this.label="context"}async fetch(e,t){const n=await super.fetch(e,t);return n.items=n.items.map(((e,t)=>{var n,i;return{...e,icon:null!==(i=this.iconFor(null!==(n=e.type)&&void 0!==n?n:"Text"))&&void 0!==i?i:this.iconFor("Text"),type:"<unknown>"===e.type?void 0:e.type,sortText:String.fromCharCode(t),source:this.label}})),n}iconFor(e){return this.options.iconsThemeManager.getIcon(e)||void 0}}class Be extends ve.KernelCompleterProvider{constructor(e){super(),this.options=e,this.label="kernel"}async fetch(e,t){const n=await super.fetch(e,t);return n.items=n.items.map(((e,t)=>{var n,i;return{...e,icon:null!==(i=this.iconFor(null!==(n=e.type)&&void 0!==n?n:u.KernelKind))&&void 0!==i?i:this.iconFor(u.KernelKind),sortText:String.fromCharCode(t),source:this.label}})),n}async isApplicable(e){const t=await super.isApplicable(e);if(!1===t)return!1;const n=this.options.connectionManager,i=e.widget,o=n.adapters.get(i.context.path);if(!o)return t;if(!e.editor)return console.error("No editor"),t;const r=e.editor,s=ye.ce_to_cm(r.getCursorPosition()),a=o.editors.find((e=>e.ceEditor.getEditor()==r));if(!a)return console.error("Could not get block with editor"),t;const l=je(o,a.ceEditor,s);return l?_e(o,l)===o.virtualDocument:(console.error("Could not get root position"),t)}iconFor(e){return this.options.iconsThemeManager.getIcon(e)||void 0}}var Re=n(4988),Te={};function Ie(e){return e.map((e=>{let t;if("string"==typeof e)return e;try{t=JSON.stringify({k:e}).slice(5,-1)}catch{t=""+e}return'<span class="lsp-code">'+t+"</span>"})).join(" ")}Te.styleTagTransform=D(),Te.setAttributes=k(),Te.insert=_().bind(null,"head"),Te.domAPI=w(),Te.insertStyleElement=j(),C()(Re.Z,Te),Re.Z&&Re.Z.locals&&Re.Z.locals;class Pe{constructor(e=["LSP"],t=null){t?this.element=t:(this.element=document.createElement("ul"),this.element.className="lsp-floating-console",document.body.appendChild(this.element))}bindThis(){return this}dispose(){this.element.remove()}append(e,t="log"){let n=document.createElement("li");n.innerHTML='<span class="lsp-kind">'+t+"</span>"+e,this.element.appendChild(n),this.element.scrollTop=this.element.scrollHeight}debug(...e){this.append(Ie(e),"debug")}log(...e){this.append(Ie(e),"log")}warn(...e){this.append(Ie(e),"warn")}error(...e){this.append(Ie(e),"error")}}class Le{constructor(){this.debug=window.console.debug.bind(window.console),this.log=window.console.log.bind(window.console),this.warn=window.console.warn.bind(window.console),this.error=window.console.error.bind(window.console)}dispose(){}scope(e){return this}bindThis(){return window.console}}class Oe{constructor(e=["LSP"],t){this.breadcrumbs=e,this._scope=this.breadcrumbs.join(".")+":",this.singleton=t,this.singleton.changed.connect(this._rebindFunctions.bind(this)),this._rebindFunctions()}_rebindFunctions(){const e=()=>{},t=this.implementation.bindThis();"debug"===this.verbosity?this.debug=this.implementation.debug.bind(t,this._scope):this.debug=e,"debug"===this.verbosity||"log"===this.verbosity?this.log=this.implementation.log.bind(t,this._scope):this.log=e,"debug"===this.verbosity||"log"===this.verbosity||"warn"===this.verbosity?this.warn=this.implementation.warn.bind(t,this._scope):this.warn=e,this.error=this.implementation.error.bind(t,this._scope)}get verbosity(){return this.singleton.verbosity}get implementation(){return this.singleton.implementation}debug(...e){return this.implementation.debug(this._scope,...e)}log(...e){return this.implementation.log(this._scope,...e)}warn(...e){return this.implementation.warn(this._scope,...e)}error(...e){return this.implementation.error(this._scope,...e)}scope(e){return new Oe([...this.breadcrumbs,e],this.singleton)}}class Fe{constructor(e){this.verbosity="debug",this.implementation=new Le,this.changed=new Ce.Signal(this),e.load(r+":plugin").then((e=>{this.updateSettings(e),e.changed.connect((()=>{this.updateSettings(e)}))})).catch(console.warn)}updateSettings(e){const t=e.composite,n=t.loggingConsole;this.implementation&&this.implementation.dispose(),"browser"===n?this.implementation=new Le:"floating"===n?this.implementation=new Pe:(console.warn("Unknown console type",n,"falling back to browser console"),this.implementation=new Le),this.verbosity=t.loggingLevel,this.changed.emit()}}const Ne={id:r+":ILSPLogConsole",requires:[m.ISettingRegistry],activate:(e,t)=>{const n=new Fe(t);return new Oe(["LSP"],n)},provides:s,autoStart:!0};var ze=n(445);class He{get isDocumentationMarkdown(){return this._isDocumentationMarkdown}constructor(e){this.options=e;const t=e.match;this.label=t.label,this._setDocumentation(t.documentation),this._resolved=!1,this._detail=t.detail,this._match=t,this.self=this,this.source=e.source,this.icon=e.icon?e.icon:void 0,Ve(this,"insertText"),Ve(this,"sortText"),Ve(this,"filterText")}get type(){return this.options.type}get insertText(){return this._currentInsertText||this._match.insertText||this._match.label}set insertText(e){this._currentInsertText=e}get sortText(){return this._currentSortText||this._match.sortText||this._match.label}set sortText(e){this._currentSortText=e}get filterText(){return this._match.filterText}set filterText(e){this._match.filterText=e}get detail(){return this._detail}needsResolution(){return!this.documentation&&!this._resolved&&this._supportsResolution()}isResolved(){return this._resolved}async resolve(){if(this._resolved)return this;if(!this._supportsResolution())return this;const e=this.options.connection,t=await e.clientRequests["completionItem/resolve"].request(this._match);return null===t||(this._setDocumentation(null==t?void 0:t.documentation),this._detail=null==t?void 0:t.detail,this._resolved=!0),this}get documentation(){if(this._documentation)return this._documentation}get deprecated(){return this._match.deprecated?this._match.deprecated:null!=this._match.tags&&this._match.tags.some((e=>e==ze.we.Deprecated))}_setDocumentation(e){ze.A_.is(e)?(this._documentation=e.value,this._isDocumentationMarkdown="markdown"===e.kind):(this._documentation=e,this._isDocumentationMarkdown=!1)}_supportsResolution(){var e,t;return null!==(t=null===(e=this.options.connection.serverCapabilities.completionProvider)||void 0===e?void 0:e.resolveProvider)&&void 0!==t&&t}}function Ve(e,t){const n=function(e,t){for(;e;){const n=Object.getOwnPropertyDescriptor(e,t);if(n)return n;e=Object.getPrototypeOf(e)}throw Error(`No ${t} descriptor found.`)}(e,t);Object.defineProperty(e,t,{enumerable:!0,get:n.get,set:n.set})}var qe=n(6697);function $e(e){let t=document.createElement("span");return t.textContent=e,t.innerHTML}class We extends ve.CompleterModel{constructor(e={}){super(),this.settings={...We.defaultOptions,...e}}completionItems(){let e=this.query;this.query="";let t=super.completionItems().map(this.harmoniseItem);return this.query=e,this._sortAndFilter(e,t)}harmoniseItem(e){return e}setCompletionItems(e){if(super.setCompletionItems(e),this.current&&this.cursor){const{start:e,end:t}=this.cursor,{text:n,line:i,column:o}=this.original,r=n.substring(e,t).trim(),s=n.split("\n")[i].substring(0,o).trim();let a="";for(let e=r.length;e>0;e--)if(r.slice(0,e)==s.slice(-e)){a=s.slice(-e);break}if(!a)return;let l=!1;(a.startsWith('"')||a.startsWith("'"))&&(a=a.substring(1),l=!0),(a.endsWith('"')||a.endsWith("'"))&&(a=a.substring(0,-1),l=!0),(this.settings.preFilterMatches||l)&&(this.query=a)}}_markFragment(e){return`<mark>${e}</mark>`}getFilterText(e){return this.getHighlightableLabelRegion(e)}getHighlightableLabelRegion(e){const t=e.label.indexOf("(");return t>-1?e.label.substring(0,t):e.label}createPatch(e){if(!this.subsetMatch)return super.createPatch(e)}_sortAndFilter(e,t){let n=[];for(let i of t){let t,o=null,r=null,s=e.toLowerCase();if(e?(o=this.getFilterText(i),r=this.settings.caseSensitive?qe.StringExt.matchSumOfSquares(o,e):qe.StringExt.matchSumOfSquares(o.toLowerCase(),s),t=!!r,this.settings.includePerfectMatches||(t=t&&o!=e)):t=!0,t){let t,s,a=null;if(e){let t=$e(this.getHighlightableLabelRegion(i));a=t==o?r:qe.StringExt.matchSumOfSquares(t,e)}a?(t=qe.StringExt.highlight($e(i.label),a.indices,this._markFragment).join(""),s=a.score):(t=$e(i.label),s=0);const l=Object.create(Object.getPrototypeOf(i),Object.getOwnPropertyDescriptors(i));l.label=t,l.insertText=i.insertText?i.insertText:i.label,n.push({item:l,score:s})}}return n.sort(this.compareMatches.bind(this)),n.map((e=>e.item))}compareMatches(e,t){var n,i,o;const r=e.score-t.score;return 0!==r?r:null!==(o=null===(n=e.item.insertText)||void 0===n?void 0:n.localeCompare(null!==(i=t.item.insertText)&&void 0!==i?i:""))&&void 0!==o?o:0}}!function(e){e.defaultOptions={caseSensitive:!0,includePerfectMatches:!0,preFilterMatches:!0,kernelCompletionsFirst:!1}}(We||(We={}));class Ue extends We{getFilterText(e){return e.filterText?e.filterText:super.getFilterText(e)}harmoniseItem(e){if(e.self){const t=e.self;return t.insertText=e.insertText,t}return super.harmoniseItem(e)}compareMatches(e,t){var n,i,o,r;const s={LSP:1,kernel:this.settings.kernelCompletionsFirst?0:2,context:3};return(e.item.source&&null!==(n=s[e.item.source])&&void 0!==n?n:4)-(t.item.source&&null!==(i=s[t.item.source])&&void 0!==i?i:4)||(null!==(o=e.item.sortText)&&void 0!==o?o:"z").localeCompare(null!==(r=t.item.sortText)&&void 0!==r?r:"z")||e.score-t.score}}class Ge extends ve.Completer.Renderer{constructor(e){super(),this.options=e,this.ITEM_PLACEHOLDER_CLASS="lsp-detail-placeholder",this.EXTRA_INFO_CLASS="jp-Completer-typeExtended",this.LABEL_CLASS="jp-Completer-match",this.elementToItem=new WeakMap,this.visibilityObserver=new IntersectionObserver((e=>{e.forEach((e=>{if(!e.isIntersecting)return;let t=e.target;this.elementToItem.get(t).resolve().catch(console.error)}))}),{threshold:.25})}getExtraInfo(e){var t,n,i,o;const r=this.options.settings.composite.labelExtra;switch(r){case"detail":return(null==e?void 0:e.detail)||"";case"type":return null===(n=null===(t=null==e?void 0:e.type)||void 0===t?void 0:t.toLowerCase)||void 0===n?void 0:n.call(t);case"source":return null==e?void 0:e.source;case"auto":return[(null==e?void 0:e.detail)||"",null===(o=null===(i=null==e?void 0:e.type)||void 0===i?void 0:i.toLowerCase)||void 0===o?void 0:o.call(i),null==e?void 0:e.source].filter((e=>!!e))[0];default:return this.options.console.warn("labelExtra does not match any of the expected values",r),""}}updateExtraInfo(e,t){const n=this.getExtraInfo(e);n&&(t.getElementsByClassName(this.EXTRA_INFO_CLASS)[0].textContent=n,this._elideMark(e,t))}createCompletionItemNode(e,t){const n=super.createCompletionItemNode(e,t),i=e.self;return i?(i.element=n,this.elementToItem.set(n,i),this.visibilityObserver.observe(n),this.updateExtraInfo(i,n),this._elideMark(i,n)):(this.updateExtraInfo(e,n),this._elideMark(i,n)),n}_elideMark(e,t){if(!e||!e.type)return;const n=e.type.toLowerCase();if("file"!==n&&"path"!==n)return;const i=t.getElementsByClassName(this.LABEL_CLASS)[0],o=i.childNodes;let r=!1;for(const e of o)if(e instanceof HTMLElement){const t=e,n=t.textContent;if("MARK"===t.tagName&&n&&n.length>3){const e=document.createElement("bdo");e.setAttribute("dir","ltr"),e.textContent=n,t.title=n,t.replaceChildren(e),t.classList.add("lsp-elide"),r=!0}}if(r){const e=document.createElement("div");e.className="lsp-elide-wrapper",e.replaceChildren(...i.childNodes),i.replaceChildren(e)}}createDocumentationNode(e){if(e.isDocumentationMarkdown&&this.options.markdownRenderer){let t=e.documentation;return this.options.markdownRenderer.renderModel({data:{"text/markdown":t},trusted:!1,metadata:{},setData(e){}}).then((()=>{this.options.markdownRenderer&&this.options.latexTypesetter&&t&&t.includes("$")&&this.options.latexTypesetter.typeset(this.options.markdownRenderer.node)})).catch(this.options.console.warn),this.options.markdownRenderer.node}if("LSP"!=e.source)return super.createDocumentationNode(e);{let t=document.createElement("pre");return e.documentation&&(t.textContent=e.documentation),t}}itemWidthHeuristic(e){const t=e.label.replace(/<(\/)?mark>/g,"").length,n=this.getExtraInfo(e).length;return"side-by-side"===this.options.settings.composite.layout?t+n:Math.max(t,n)}}class Ze{constructor(e){this.options=e,this.identifier="lsp",this.label="LSP",this.rank=1e3,this.console=(new Le).scope("Completion provider"),this.modelFactory=async e=>{const t=this.options.settings.composite,n=new Ue({caseSensitive:t.caseSensitive,preFilterMatches:t.preFilterMatches,includePerfectMatches:t.includePerfectMatches,kernelCompletionsFirst:t.kernelCompletionsFirst});return this.options.settings.changed.connect((()=>{const e=this.options.settings.composite;n.settings.caseSensitive=e.caseSensitive,n.settings.preFilterMatches=e.preFilterMatches,n.settings.includePerfectMatches=e.includePerfectMatches,n.settings.kernelCompletionsFirst=e.kernelCompletionsFirst})),n};const t=e.renderMimeRegistry.createRenderer("text/markdown");this.renderer=new Ge({settings:e.settings,markdownRenderer:t,latexTypesetter:e.renderMimeRegistry.latexTypesetter,console:this.console})}async resolve(e){return await e.resolve(),{label:e.label,documentation:e.documentation,deprecated:e.deprecated,detail:e.detail,filterText:e.filterText,sortText:e.sortText,insertText:e.insertText,source:e.source,type:e.type,isDocumentationMarkdown:e.isDocumentationMarkdown,icon:e.icon}}shouldShowContinuousHint(e,t,n){var i,o;if(!n)return!1;const r=this.options.connectionManager,s=null==n?void 0:n.widget,a=r.adapters.get(s.context.path);if(!n.editor)throw Error("No editor");if(!a)throw Error("No adapter");const l=n.editor,c=ye.ce_to_cm(l.getCursorPosition()),d=a.editors.find((e=>e.ceEditor.getEditor()==l));if(!d)throw Error("Could not get block with editor");const u=je(a,d.ceEditor,c);if(!u)throw Error("Could not get root position");const p=_e(a,u),g=r.connections.get(p.uri);if(!g)throw Error("Could not find connection for virtual document");const h=(null===(o=null===(i=g.serverCapabilities)||void 0===i?void 0:i.completionProvider)||void 0===o?void 0:o.triggerCharacters)||[],m=t.sourceChange;if(null==m)return!1;if(m.some((e=>null!=e.delete)))return!1;const f=l.getTokenAtCursor();return!(!this.options.settings.composite.continuousHinting||!f.type||this.options.settings.composite.suppressContinuousHintingIn.includes(f.type))||!(!f.type||this.options.settings.composite.suppressTriggerCharacterIn.includes(f.type))&&m.some((t=>null!=t.insert&&(h.includes(t.insert)||!e&&t.insert.trim().length>0)))}async fetch(e,t,n){const i=this.options.connectionManager,o=t.widget,r=i.adapters.get(o.context.path);if(!t.editor)throw Error("No editor");if(!r)throw Error("No adapter");const s=t.editor,a=ye.ce_to_cm(s.getPositionAt(e.offset)),l=s.getTokenAt(e.offset),c=e.offset-l.offset,d=l.value[c-1],u=r.editors.find((e=>e.ceEditor.getEditor()==s));if(!u)throw Error("Could not get block with editor");const p=je(r,u.ceEditor,a);if(!p)throw Error("Could not get root position");const g=_e(r,p),h=ke(r,p),m=i.connections.get(g.uri);if(!m)throw Error("Could not find connection for virtual document");const f=await m.clientRequests["textDocument/completion"].request({textDocument:{uri:g.documentInfo.uri},position:{line:h.line,character:h.ch},context:{triggerKind:n||me.Invoked,triggerCharacter:n===me.TriggerCharacter?d:void 0}});return function(e,t,n,i,o){let r=e.value.slice(0,t),s=e.value.slice(t,e.value.length),a=[],l=!1;n.forEach((t=>{let n=t.kind?ge[t.kind]:"",o=t.insertText?t.insertText:t.label,c=t.insertText?t.insertText:t.label;if(c.toLowerCase().startsWith(r.toLowerCase())&&(l=!0),c.startsWith(e.value)&&(l=!0,c.startsWith(r)&&(o=o.substring(r.length,o.length),t.insertText=o),o=e.value+o,t.insertText=o),"String"===e.type&&r.includes("/")){const e=(d=r,d.slice(d.startsWith("'")||d.startsWith('"')?1:0,d.endsWith("'")||d.endsWith('"')?-1:d.length)).split("/");if(o.toLowerCase().startsWith(e[e.length-1].toLowerCase())){let n=e.slice(0,-1).join("/")+"/";o=(r.startsWith("'")||r.startsWith('"')?r[0]:"")+n+o+(s.startsWith("'")||s.startsWith('"')?s[0]:""),t.insertText=o,t.label=n+t.label,l=!0}}else o.toLowerCase().endsWith(s.toLowerCase())?(o=o.substring(0,o.length-s.length),t.insertText=o):"String"===e.type&&(s.startsWith("'")||s.startsWith('"'))&&(t.insertText=o+s[0]);var d;let u=i(n,t);a.push(u)})),o.debug("Transformed");let c=e.offset,d=e.offset+e.value.length;l||(c=d);let u={start:c,end:d,items:a,source:"LSP"};return u.start>u.end&&o.warn("Response contains start beyond end; this should not happen!",u),u}(l,c,(!f||Array.isArray(f)?{isIncomplete:!1,items:f||[]}:f).items,((e,t)=>new He({match:t,connection:m,type:e,icon:this.options.iconsThemeManager.getIcon(e),source:this.label})),this.console)}async isApplicable(e){if(this.options.settings.composite.disable)return!1;const t=this.options.connectionManager,n=e.widget;return!!t.adapters.get(n.context.path)}}new v.LabIcon({name:"lsp:completion",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">\n  <g class="jp-icon3 jp-icon-selectable" fill="#616161" shape-rendering="geometricPrecision">\n     <path d="M5,9.5L7.5,14H2.5L5,9.5M3,4H7V8H3V4M5,20A2,2 0 0,0 7,18A2,2 0 0,0 5,16A2,2 0 0,0 3,18A2,2 0 0,0 5,20M9,5V7H21V5H9M9,19H21V17H9V19M9,13H21V11H9V13Z" />\n  </g>\n</svg>\n'});class Je extends be{constructor(e){super(e),this.options=e,this.id=Je.id,this.capabilities={textDocument:{completion:{dynamicRegistration:!0,completionItem:{snippetSupport:!1,commitCharactersSupport:!0,documentationFormat:["markdown","plaintext"],deprecatedSupport:!0,preselectSupport:!1,tagSupport:{valueSet:[pe.Deprecated]}},contextSupport:!0}}},this._configure(),e.settings.changed.connect((()=>{this._configure()}));const t=new Ze({...e});e.completionProviderManager.registerProvider(t),e.completionProviderManager.registerProvider(new De(e)),e.completionProviderManager.registerProvider(new Be(e))}_configure(){const e=this.options.settings,t=this.options.iconsThemeManager;e.composite.disable?(t.setTheme(null),delete document.body.dataset.lspCompleterLayout):(document.body.dataset.lspCompleterLayout=e.composite.layout,t.setTheme(e.composite.theme),t.setIconsOverrides(e.composite.typesMap))}}!function(e){e.id=r+":completion"}(Je||(Je={}));const Ke={id:Je.id,requires:[a.ILSPFeatureManager,m.ISettingRegistry,ve.ICompletionProviderManager,u.ILSPCompletionThemeManager,Ee.IRenderMimeRegistry,a.ILSPDocumentConnectionManager],autoStart:!0,activate:async(e,t,n,i,o,r,s)=>{const a=new we(n,Je.id);if(await a.ready,a.composite.disable)return;const l=new Je({settings:a,connectionManager:s,renderMimeRegistry:r,iconsThemeManager:o,completionProviderManager:i});t.register(l)}};var Ye=n(1920),Xe=n(3627);class Qe{constructor(e){this.options=e,this.console=(new Le).scope("ContexAssembler"),this._wasOverToken=!1}getContext(){let e=null;try{e=this.getContextFromContextMenu()}catch(t){this.console.warn("contextMenu is attached, but could not get the context",t),e=null}if(null==e)try{e=this._contextFromActiveDocument()}catch(e){if(!(e instanceof Error&&"Source line not mapped to virtual position"===e.message))throw e;this.console.log("Could not get context from active document: it is expected when restoring workspace with open files")}return e}isContextMenuOverToken(){const e=this.getContextFromContextMenu();if(!e)return this._wasOverToken;const{rootPosition:t,adapter:n}=e,i=xe(n,t).getEditor();if(!i)return;const o=Se(n,t),r=i.getOffsetAt(ye.cm_to_ce(o)),s=""!==i.getTokenAt(r).value;return this._wasOverToken=s,s}_contextFromActiveDocument(){const e=[...this.options.connectionManager.adapters.values()].find((e=>e.widget==this.options.app.shell.currentWidget));if(!e)return this.console.debug("No adapter"),null;const t=e.activeEditor.getEditor();if(null===t)return null;let n=t.getCursorPosition(),i=ye.ce_to_cm(n);const o=e.virtualDocument;if(!o)return console.warn("Could not retrieve current context",o),null;const r=o.transformFromEditorToRoot(e.activeEditor,i);return null==r?(console.warn("Could not retrieve current context",o),null):this._contextFromRoot(e,r)}_contextFromRoot(e,t){const n=_e(e,t);return{document:n,connection:this.options.connectionManager.connections.get(n.uri),virtualPosition:ke(e,t),rootPosition:t,adapter:e}}adapterFromNode(e){return[...this.options.connectionManager.adapters.values()].find((t=>t.widget.node.contains(e)))}positionFromCoordinates(e,t,n,i){if(!i)return null;const o=this.editorPositionFromCoordinates(e,t,i);return o?je(n,i,o):null}editorPositionFromCoordinates(e,t,n){const i=n.getEditor();if(!i)return null;const o=i.getPositionForCoordinate({left:e,right:e,bottom:t,top:t,y:t,x:e,width:0,height:0});return o?{ch:o.column,line:o.line}:null}editorFromNode(e,t){var n;const i=t.closest(".cm-content");if(!i)return;const o=null===(n=null==i?void 0:i.cmView)||void 0===n?void 0:n.view;if(!o)return;const r=e.editors.map((e=>e.ceEditor)).find((e=>{var t;return(null===(t=e.getEditor())||void 0===t?void 0:t.editor)===o}));return r}getContextFromContextMenu(){const e=this.options.app.contextMenuHitTest((()=>!0));if(!e)return null;let{left:t,top:n}=e.getBoundingClientRect(),i=this.options.app._contextMenuEvent;void 0!==i&&(t=i.clientX,n=i.clientY,i.stopPropagation());const o=this.adapterFromNode(e);if(!o)return null;const r=this.editorFromNode(o,e);r||this.console.warn("Editor accessor not found from node, falling back to activeEditor");const s=r||o.activeEditor,a=this.positionFromCoordinates(t,n,o,s);return a?this._contextFromRoot(o,a):null}}var et=n(8778),tt=n(6211),nt=n(2697),it=n(7065),ot=n(287);const rt='<svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">\n  <g class="jp-icon3 jp-icon-selectable" fill="#616161" shape-rendering="geometricPrecision">\n    <path d="M12 14a2 2 0 012 2 2 2 0 01-2 2 2 2 0 01-2-2 2 2 0 012-2m11.46-5.14l-1.59 6.89L15 14.16l3.8-2.38A7.972 7.972 0 0012 8c-3.95 0-7.23 2.86-7.88 6.63l-1.97-.35C2.96 9.58 7.06 6 12 6c3.58 0 6.73 1.89 8.5 4.72l2.96-1.86z"/>\n  </g>\n</svg>\n';n(8644);const st=/^file:\/\/([^\/]+|\/[a-zA-Z](?::|%3A))/;function at(e,t){const n=e.key||null;let i=!1;switch(t){case"Shift":i=e.shiftKey||"Shift"==n;break;case"Alt":i=e.altKey||"Alt"==n;break;case"AltGraph":i="AltGraph"==n;break;case"Control":i=e.ctrlKey||"Control"==n;break;case"Meta":i=e.metaKey||"Meta"==n;break;case"Accel":i=e.metaKey||"Meta"==n||e.ctrlKey||"Control"==n}return void 0!==e.getModifierState?i||e.getModifierState(t):i}class lt extends Map{constructor(e,t){super(t),this.defaultFactory=e}get(e){return this.getOrCreate(e)}getOrCreate(e,...t){if(this.has(e))return super.get(e);{let n=this.defaultFactory(e,...t);return this.set(e,n),n}}}function ct(e,t){return dt(e)&&dt(t)&&(e=ut(e),t=ut(t)),e===t||decodeURI(e)===decodeURI(t)}function dt(e){return e.match(st)}function ut(e){return e.replace(st,(e=>e.replace("%3A",":").toLowerCase()))}function pt(e){const t={},n={},i=(e,o="")=>{for(let[r,s]of Object.entries(e)){const e=o?o+"."+r:r;null==s||"object"!=typeof s||Array.isArray(s)||0===Object.keys(s).length?(t.hasOwnProperty(e)&&t[e]!==s&&(n.hasOwnProperty(e)||(n[e]=[],n[e].push(t[e])),n[e].includes(s)||n[e].push(s)),t[e]=s):i(s,e)}};return i(e),{result:t,conflicts:n}}function gt(e){e=e.replace(/([\\#*_[\]])/g,"\\$1");const t=document.createElement("span");return t.textContent=e,t.innerHTML.replace(/\n/g,"<br>").replace(/ {2}/g,"")}const ht=new v.LabIcon({name:"lsp:jump-to",svgstr:rt}),mt=new v.LabIcon({name:"lsp:jump-back",svgstr:rt.replace("jp-icon3","lsp-icon-flip-x jp-icon3")});class ft extends be{constructor(e){super(e),this.id=ft.id,this.capabilities={textDocument:{declaration:{dynamicRegistration:!0,linkSupport:!0},definition:{dynamicRegistration:!0,linkSupport:!0},typeDefinition:{dynamicRegistration:!0,linkSupport:!0},implementation:{dynamicRegistration:!0,linkSupport:!0}}},this.console=(new Le).scope("Navigation"),this.settings=e.settings,this._trans=e.trans,this.contextAssembler=e.contextAssembler;const t=e.connectionManager;e.editorExtensionRegistry.addExtension({name:"lsp:jump",factory:e=>{const n=tt.EditorView.domEventHandlers({mouseup:e=>{const n=[...t.adapters.values()].find((t=>t.widget.node.contains(e.target)));n?this._jumpOnMouseUp(e,n):this.console.warn("Adapter not found")}});return Xe.EditorExtensionRegistry.createImmutableExtension([n])}}),this._jumpers=new Map;const{fileEditorTracker:n,notebookTracker:i,documentManager:o}=e;null!==n&&n.widgetAdded.connect(((e,t)=>{if(t.content.editor instanceof Xe.CodeMirrorEditor){let e=new nt.FileEditorJumper(t,o);this._jumpers.set(t.id,e)}})),i.widgetAdded.connect((async(e,t)=>{let n=new nt.NotebookJumper(t,o);this._jumpers.set(t.id,n)}))}getJumper(e){let t=e.widget.id;return this._jumpers.get(t)}get modifierKey(){return this.settings.composite.modifierKey}_jumpOnMouseUp(e,t){if("Alt"!==this.modifierKey)return this._jumpToDefinitionOrRefernce(e,t);document.body.addEventListener("mouseup",(n=>{if(n.target===e.target)return this._jumpToDefinitionOrRefernce(e,t)}),{once:!0})}_jumpToDefinitionOrRefernce(e,t){const{button:n}=e;if(0!==n||!at(e,this.modifierKey))return;const i=this.contextAssembler.editorFromNode(t,e.target);i||this.console.warn("Editor accessor not found from node, falling back to activeEditor");const o=i||t.activeEditor,r=this.contextAssembler.positionFromCoordinates(e.clientX,e.clientY,t,o);if(null==r)return void this.console.warn("Could not retrieve root position from mouse event to jump to definition/reference");const s=ke(t,r),a=_e(t,r),l=this.connectionManager.connections.get(a.uri),c={textDocument:{uri:a.documentInfo.uri},position:{line:s.line,character:s.ch}};l.clientRequests["textDocument/definition"].request(c).then((e=>{this.handleJump(e,c,t,a).then((e=>{1!==e&&6!==e||l.clientRequests["textDocument/references"].request({...c,context:{includeDeclaration:!1}}).then((e=>this.handleJump(e,c,t,a))).catch(this.console.warn)})).catch(this.console.warn)})).catch(this.console.warn),e.preventDefault(),e.stopPropagation()}_harmonizeLocations(e){return null==e?[]:(Array.isArray(e)?e:[e]).map((e=>"targetUri"in e?{uri:e.targetUri,range:e.targetRange}:"uri"in e?{uri:e.uri,range:e.range}:void this.console.warn("Returned jump location is incorrect (no uri or targetUri):",e))).filter((e=>null!=e))}async _chooseTarget(e){if(e.length>1){const t=e.map((e=>(this._resolvePath(e.uri)||e.uri)+", line: "+e.range.start.line));let n={title:this._trans.__("Choose the jump target"),okLabel:this._trans.__("Jump"),items:t};const i=await V.InputDialog.getItem(n).catch(this.console.warn);if(!i||null==i.value)return void this.console.warn("No choice selected for jump location selection");const o=t.indexOf(i.value);return-1===o?void this.console.error("Choice selection error: please report this as a bug:",t,i):e[o]}return e[0]}_resolvePath(e){let t=(n=e,null==(i=i||it.PageConfig.getOption("rootUri"))?null:n.startsWith(i)?decodeURIComponent(n.replace(i,"")):null);var n,i;return null==t&&(t=e.startsWith("file://")?decodeURIComponent(e.slice(7)):decodeURIComponent(e)),t}async handleJump(e,t,n,i){const o=this._harmonizeLocations(e),r=await this._chooseTarget(o),s=this.getJumper(n);if(!r)return V.Notification.info(this._trans.__("No jump targets found"),{autoClose:3e3}),1;let{uri:l,range:c}=r,d=ye.lsp_to_cm(c.start);if(ct(l,t.textDocument.uri)){const e=L.prototype.transformVirtualToRoot.call(i,d);if(null===e)return this.console.warn("Could not jump: conversion from virtual position to editor position failed",d),2;const r=Se(n,e),u=xe(n,e);await u.reveal();const p=u.getEditor(),g=n.editors.findIndex((e=>e.ceEditor.getEditor()===p));if(-1===g)return 2;this.console.log(`Jumping to ${g}th editor of ${l}`),this.console.log("Jump target within editor:",r);let h=n.widget.context.path;return o.length>1||!a.ProtocolCoordinates.isWithinRange(t.position,c)?(s.globalJump({line:r.line,column:r.ch,editorIndex:g,isSymlink:!1,contentsPath:h}),4):6}{let e=ye.cm_to_ce(d);this.console.log(`Jumping to external file: ${l}`),this.console.log("Jump target (source location):",e);let t={editorIndex:0,line:e.line,column:e.column};const n=this._resolvePath(l);if(null===n)return this.console.warn("contents_path could not be resolved"),3;try{return await s.documentManager.services.contents.get(n,{content:!1}),s.globalJump({contentsPath:n,...t,isSymlink:!1}),4}catch(e){this.console.warn(e)}return s.globalJump({contentsPath:it.URLExt.join(".lsp_symlink",n),...t,isSymlink:!0}),4}}}var At;!function(e){e.id=r+":jump_to"}(ft||(ft={})),function(e){e.jumpToDefinition="lsp:jump-to-definition",e.jumpToReference="lsp:jump-to-reference",e.jumpBack="lsp:jump-back"}(At||(At={}));const vt={id:ft.id,requires:[a.ILSPFeatureManager,m.ISettingRegistry,a.ILSPDocumentConnectionManager,N.INotebookTracker,ot.IDocumentManager,Xe.IEditorExtensionRegistry],optional:[T.IEditorTracker,V.ICommandPalette,A.ITranslator],autoStart:!0,activate:async(e,t,n,i,o,r,s,a,l,c)=>{const d=(c||A.nullTranslator).load("jupyterlab_lsp"),u=new Qe({app:e,connectionManager:i}),p=new we(n,ft.id);if(await p.ready,p.composite.disable)return;const g=new ft({settings:p,connectionManager:i,notebookTracker:o,documentManager:r,fileEditorTracker:a,contextAssembler:u,editorExtensionRegistry:s,trans:d});t.register(g),e.commands.addCommand(At.jumpToDefinition,{execute:async()=>{const e=u.getContext();if(!e)return void console.warn("Could not get context");const{connection:t,virtualPosition:n,document:i,adapter:o}=e;if(!t)return void V.Notification.warning(d.__("Connection not found for jump"),{autoClose:4e3});const r={textDocument:{uri:i.documentInfo.uri},position:{line:n.line,character:n.ch}},s=await t.clientRequests["textDocument/definition"].request(r);await g.handleJump(s,r,o,i)},label:d.__("Jump to definition"),icon:ht,isEnabled:()=>{const e=u.getContext();if(!e)return console.warn("Could not get context"),!1;const{connection:t}=e;return!!t&&t.provides("definitionProvider")}}),e.commands.addCommand(At.jumpToReference,{execute:async()=>{const e=u.getContext();if(!e)return void console.warn("Could not get context");const{connection:t,virtualPosition:n,document:i,adapter:o}=e;if(!t)return void V.Notification.warning(d.__("Connection not found for jump"),{autoClose:5e3});const r={textDocument:{uri:i.documentInfo.uri},position:{line:n.line,character:n.ch}},s=await t.clientRequests["textDocument/references"].request({...r,context:{includeDeclaration:!1}});await g.handleJump(s,r,o,i)},label:d.__("Jump to references"),icon:ht,isEnabled:()=>{const e=u.getContext();if(!e)return console.warn("Could not get context"),!1;const{connection:t}=e;return!!t&&t.provides("referencesProvider")}}),e.commands.addCommand(At.jumpBack,{execute:async()=>{const e=u.getContext();e?g.getJumper(e.adapter).globalJumpBack():console.warn("Could not get context")},label:d.__("Jump back"),icon:mt,isEnabled:()=>{const e=u.getContext();if(!e)return console.warn("Could not get context"),!1;const{connection:t}=e;return!!t&&(t.provides("definitionProvider")||t.provides("referencesProvider"))}});for(const t of[At.jumpToDefinition,At.jumpToReference])e.contextMenu.addItem({selector:".jp-Notebook .jp-CodeCell .jp-Editor",command:t,rank:10}),e.contextMenu.addItem({selector:".jp-FileEditor",command:t,rank:0});for(const e of[At.jumpToDefinition,At.jumpToReference,At.jumpBack])l&&l.addItem({command:e,category:d.__("Language Server Protocol")})}};var Et=n(2372),Ct={};Ct.styleTagTransform=D(),Ct.setAttributes=k(),Ct.insert=_().bind(null,"head"),Ct.domAPI=w(),Ct.insertStyleElement=j(),C()(Et.Z,Ct),Et.Z&&Et.Z.locals&&Et.Z.locals;const bt="lsp-diagnostics-listing",wt="lsp-diagnostics-placeholder";class yt extends Map{get all(){return[].concat.apply([],this.values())}}class _t{constructor(e){this.options=e,this.isVisible=!0}renderCell(e,t){return this.options.renderCell(e,t)}sort(e,t){return this.options.sort(e,t)}get id(){return this.options.id}isAvailable(e){return null==this.options.isAvailable||this.options.isAvailable(e)}renderHeader(e){return $().createElement(xt,{label:this.options.label,id:this.id,listing:e,key:this.id})}}function xt(e){const t=e.id===e.listing.sortKey,n=t&&1!==e.listing.sortDirection?v.caretDownIcon:v.caretUpIcon;return $().createElement("th",{key:e.id,onClick:()=>e.listing.sort(e.id),className:t?"lsp-sorted-header":void 0,"data-id":e.id},$().createElement("div",null,$().createElement("label",null,e.label),$().createElement(n.react,{tag:"span",className:"lsp-sort-icon"})))}class kt extends V.VDomRenderer{constructor(e){super(e),this.sortKey="Severity",this.sortDirection=1;const t=e.trans;this.trans=t,this.severityTranslations={Error:t.__("Error"),Warning:t.__("Warning"),Information:t.__("Information"),Hint:t.__("Hint")},this.columns=[new _t({id:"Virtual Document",label:this.trans.__("Virtual Document"),renderCell:(e,t)=>$().createElement("td",{key:0},$().createElement(X,{document:e.document,adapter:t.adapter,trans:this.trans})),sort:(e,t)=>e.document.idPath.localeCompare(t.document.idPath),isAvailable:e=>e.db.size>1}),new _t({id:"Message",label:this.trans.__("Message"),renderCell:e=>{let t=function(e){let t=e.message,n=""+e.code;return null!=e.code&&""!==e.code&&t.startsWith(n+"")?t.slice(n.length).trim():t}(e.data.diagnostic);return $().createElement("td",{key:1},t)},sort:(e,t)=>e.data.diagnostic.message.localeCompare(t.data.diagnostic.message)}),new _t({id:"Code",label:this.trans.__("Code"),renderCell:e=>$().createElement("td",{key:2},e.data.diagnostic.code),sort:(e,t)=>(e.data.diagnostic.code+"").localeCompare(t.data.diagnostic.source+"")}),new _t({id:"Severity",label:this.trans.__("Severity"),renderCell:e=>{const t=de[e.data.diagnostic.severity||1];return $().createElement("td",{key:3},this.severityTranslations[t]||t)},sort:(e,t)=>e.data.diagnostic.severity?t.data.diagnostic.severity&&e.data.diagnostic.severity>t.data.diagnostic.severity?1:-1:1}),new _t({id:"Source",label:this.trans.__("Source"),renderCell:e=>$().createElement("td",{key:4},e.data.diagnostic.source),sort:(e,t)=>e.data.diagnostic.source?t.data.diagnostic.source?e.data.diagnostic.source.localeCompare(t.data.diagnostic.source):-1:1}),new _t({id:"Cell",label:this.trans.__("Cell"),renderCell:e=>$().createElement("td",{key:5},e.cellNumber),sort:(e,t)=>e.cellNumber-t.cellNumber||e.data.range.start.line-t.data.range.start.line||e.data.range.start.ch-t.data.range.start.ch,isAvailable:e=>e.adapter.hasMultipleEditors}),new _t({id:"Line:Ch",label:this.trans.__("Line:Ch"),renderCell:e=>$().createElement("td",{key:6},e.data.range.start.line,":",e.data.range.start.ch),sort:(e,t)=>e.data.range.start.line-t.data.range.start.line||e.data.range.start.ch-t.data.range.start.ch})]}sort(e){e===this.sortKey?this.sortDirection=-1*this.sortDirection:(this.sortKey=e,this.sortDirection=1),this.update()}render(){let e=this.model.diagnostics;const t=this.model.adapter;if(null==e||!t)return $().createElement("div",{className:wt},$().createElement("h3",null,"No diagnostics"),this.trans.__("Diagnostics panel shows linting results in notebooks and files connected to a language server."));if(0===e.size)return $().createElement("div",{className:wt},this.trans.__("No issues detected, great job!"));let n=Array.from(e).map((([e,n])=>e.isDisposed?[]:n.map(((n,i)=>{let o=null;return t.hasMultipleEditors&&(o=t.editors.findIndex((e=>e.ceEditor==n.editorAccessor))+1),{data:n,key:e.uri+","+i,document:e,cellNumber:o}})))),i=[].concat.apply([],n);this._diagnostics=new Map(i.map((e=>[e.key,e])));let o=this.columns.filter((e=>e.id===this.sortKey))[0],r=o.sort.bind(o),s=i.sort(((e,t)=>r(e,t)*this.sortDirection)),a={db:e,adapter:t},l=this.columns.filter((e=>e.isAvailable(a)&&e.isVisible)),c=s.map((e=>{let t=l.map((t=>t.renderCell(e,a)));return $().createElement("tr",{key:e.key,"data-key":e.key,onClick:()=>this.jumpTo(e)},t)})),d=l.map((e=>e.renderHeader(this)));return $().createElement("table",{className:bt},$().createElement("thead",null,$().createElement("tr",null,d)),$().createElement("tbody",null,c))}getDiagnostic(e){if(this._diagnostics.has(e))return this._diagnostics.get(e);console.warn("Could not find the diagnostics row with key",e)}async jumpTo(e){const t=await e.data.editorAccessor.reveal();t.setCursorPosition(ye.cm_to_ce(e.data.range.start)),t.focus()}}!function(e){class t extends V.VDomModel{constructor(e){super(),this.trans=e}}e.Model=t}(kt||(kt={}));const St=new v.LabIcon({name:"lsp:diagnostics",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">\n  <g class="jp-icon3 jp-icon-selectable" fill="#616161" shape-rendering="geometricPrecision">\n    <path d="M19 8c.56 0 1 .43 1 1a1 1 0 01-1 1c-.57 0-1-.45-1-1 0-.57.43-1 1-1M2 2v9c0 2.96 2.19 5.5 5.14 5.91.62 3.01 3.28 5.09 6.36 5.09a6.5 6.5 0 006.5-6.5v-3.69c1.16-.42 2-1.52 2-2.81a3 3 0 00-3-3 3 3 0 00-3 3c0 1.29.84 2.4 2 2.81v3.6c0 2.5-2 4.5-4.5 4.5-2 0-3.68-1.21-4.28-3.01C12 16.3 14 13.8 14 11V2h-4v3h2v6a4 4 0 01-4 4 4 4 0 01-4-4V5h2V2H2z"/>\n  </g>\n</svg>\n'}),jt="lsp-set-column-visibility",Mt="lsp-jump-to-diagnostic",Dt="lsp-copy-diagnostic",Bt="lsp-ignore-diagnostic-code",Rt="lsp-ignore-diagnostic-message",Tt=new class{constructor(e){this._content=null,this._widget=null,this.isRegistered=!1,this.trans=e}get widget(){return null!=this._widget&&null!=this._widget.content.model||(this._widget&&!this._widget.isDisposed&&this._widget.dispose(),this._widget=this.initWidget()),this._widget}get content(){return this.widget.content}initWidget(){this._content=new kt(new kt.Model(this.trans)),this._content.model.diagnostics=new yt,this._content.addClass("lsp-diagnostics-panel-content");const e=new V.MainAreaWidget({content:this._content});return e.id="lsp-diagnostics-panel",e.title.label=this.trans.__("Diagnostics Panel"),e.title.closable=!0,e.title.icon=St,e}update(){this.widget.isAttached&&this.widget.content.update()}register(e){const t=this.widget;let n=e=>{for(let n of t.content.columns)if(n.id===e)return n},i=new et.Menu({commands:e.commands});i.title.label=this.trans.__("Panel columns"),e.commands.addCommand(jt,{execute:e=>{let i=n(e.id);i.isVisible=!i.isVisible,t.update()},label:e=>this.trans.__(e.id),isToggled:e=>{let t=n(e.id);return!!t&&t.isVisible}});for(let e of t.content.columns)i.addItem({command:jt,args:{id:e.id}});e.contextMenu.addItem({selector:"."+bt+" th",submenu:i,type:"submenu"});let o=new et.Menu({commands:e.commands});o.title.label=this.trans.__("Ignore diagnostics like this");let r=()=>{let t=e.contextMenuHitTest((e=>"tr"==e.tagName.toLowerCase()));if(t)return this.widget.content.getDiagnostic(t.dataset.key)};o.addItem({command:Bt}),o.addItem({command:Rt}),e.commands.addCommand(Bt,{execute:()=>{const e=r();if(!e)return void console.warn("LPS: diagnostics row not found for ignore code execute()");const t=e.data.diagnostic;let n=this.content.model.settings.composite.ignoreCodes;this.content.model.settings.set("ignoreCodes",[...n,t.code]),this.feature.refreshDiagnostics()},isVisible:()=>{const e=r();return!!e&&!!e.data.diagnostic.code},label:()=>{const e=r();if(!e)return"";const t=e.data.diagnostic;return this.trans.__('Ignore diagnostics with "%1" code',t.code)}}),e.commands.addCommand(Rt,{execute:()=>{const e=r();if(!e)return void console.warn("LPS: diagnostics row not found for ignore message execute()");const t=e.data.diagnostic;let n=this.content.model.settings.composite.ignoreMessagesPatterns;var i;this.content.model.settings.set("ignoreMessagesPatterns",[...n,(i=t.message,i.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"))]),this.feature.refreshDiagnostics()},isVisible:()=>{const e=r();return!!e&&!!e.data.diagnostic.message},label:()=>{const e=r();if(!e)return"";const t=e.data.diagnostic;return this.trans.__('Ignore diagnostics with "%1" message',t.message)}}),e.commands.addCommand(Mt,{execute:()=>{const e=r();if(e)return this.widget.content.jumpTo(e);console.warn("LPS: diagnostics row not found for jump execute()")},label:this.trans.__("Jump to location"),icon:ht}),e.commands.addCommand(Dt,{execute:()=>{const e=r();if(!e)return void console.warn("LPS: diagnostics row not found for copy execute()");const t=e.data.diagnostic.message;navigator.clipboard.writeText(t).then((()=>{V.Notification.info(this.trans.__('Successfully copied "%1" to clipboard',t),{autoClose:3e3})})).catch((()=>{console.warn("Could not copy with clipboard.writeText interface, falling back"),window.prompt(this.trans.__("Your browser protects clipboard from write operations; please copy the message manually"),t)}))},label:this.trans.__("Copy diagnostics' message"),icon:v.copyIcon}),e.contextMenu.addItem({selector:"."+bt+" tbody tr",command:Dt}),e.contextMenu.addItem({selector:"."+bt+" tbody tr",command:Mt}),e.contextMenu.addItem({selector:"."+bt+" tbody tr",submenu:o,type:"submenu"}),this.isRegistered=!0}}(A.nullTranslator.load("jupyterlab_lsp"));var It=n(3028),Pt=n(8204),Lt=n(2921);function Ot(e){return function(e,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(e)}</svg>')`}(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${e}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const Ft={1:"error",2:"warning",3:"info",4:"hint"};class Nt extends be{constructor(e){super(e),this.id=Nt.id,this.capabilities={textDocument:{publishDiagnostics:{tagSupport:{valueSet:[ue.Deprecated,ue.Unnecessary]}}}},this.console=(new Le).scope("Diagnostics"),this._firstResponseReceived=new o.PromiseDelegate,this._diagnosticsDatabases=new WeakMap,this.switchDiagnosticsPanelSource=e=>{if(Tt.trans=this._trans,null!==e){const t=this.getDiagnosticsDB(e);if(Tt.content.model.diagnostics==t)return;Tt.content.model.diagnostics=t,Tt.content.model.settings=this.settings,Tt.feature=this}else Tt.content.model.diagnostics=null;Tt.content.model.adapter=e,Tt.update()},this.handleDiagnostic=async(e,t,n)=>{var i;if(ct(e.uri,null===(i=null==t?void 0:t.documentInfo)||void 0===i?void 0:i.uri)&&0!==t.lastVirtualLine)try{this._lastResponse=e,this._lastDocument=t,this._lastAdapter=n,this.setDiagnostics(e,t,n);const i=new Promise((e=>{setTimeout((()=>{this._firstResponseReceived.resolve(),e()}),0)}));return Tt.update(),i}catch(e){this.console.warn(e)}},this._styleElement=document.createElement("style"),this.settings=e.settings,e.connectionManager.connected.connect(((e,t)=>{const{connection:n,virtualDocument:i}=t,o=e.adapters.get(i.root.path);n.serverNotifications["textDocument/publishDiagnostics"].connect((async(e,t)=>{await this.handleDiagnostic(t,i,o)})),i.foreignDocumentClosed.connect(((e,t)=>{this.clearDocumentDiagnostics(o,t.foreignDocument)}))})),this.settings.changed.connect(this.refreshDiagnostics,this),this._trans=e.trans,this._invalidate=Pt.StateEffect.define(),this._invalidationCounter=Pt.StateField.define({create:()=>0,update:(e,t)=>{for(const n of t.effects)n.is(this._invalidate)&&(e+=1);return e}});const t=e.connectionManager;e.shell.currentChanged.connect((e=>{if(e.currentWidget==Tt.widget)return;const n=[...t.adapters.values()].find((t=>t.widget==e.currentWidget));if(n)this.switchDiagnosticsPanelSource(n);else{this.switchDiagnosticsPanelSource(null);let n=3;const i=()=>{const o=[...t.adapters.values()].find((t=>t.widget==e.currentWidget));n-=1,o&&(this.switchDiagnosticsPanelSource(o),n=0),0==n&&t.connected.disconnect(i)};t.connected.connect(i),this.console.debug("No adapter (yet?), will retry on next connected document")}}));const n=e.settings,i=e.themeManager;this._reconfigureTheme(),document.head.appendChild(this._styleElement),i&&i.themeChanged.connect((()=>{this._reconfigureTheme()})),e.editorExtensionRegistry.addExtension({name:"lsp:diagnostics",factory:e=>{const i=[(0,It.ir)((async e=>{let n=[];const i=[...t.adapters.values()].find((t=>t.widget.node.contains(e.contentDOM)));if(!i)return this.console.debug("No adapter found for editor by model. Maybe not registered yet?"),[];0==e.state.field(this._invalidationCounter)?await this._firstResponseReceived.promise:await i.updateFinished;const o=this.getDiagnosticsDB(i);for(const t of o.values())for(const i of t){const t=i.editorAccessor.getEditor();if((null==t?void 0:t.editor)!==e)continue;const o=i.diagnostic,r=Ft[o.severity],s=e.state.doc.lines,a=e.state.doc.line(s).length,l=ye.cm_to_ce(i.range.start),c=ye.cm_to_ce(i.range.end),d=t.getOffsetAt(l.line>=s?{line:Math.min(l.line,s),column:Math.min(l.column,a)}:l),u=t.getOffsetAt(c.line>=s?{line:Math.min(c.line,s),column:Math.min(c.column,a)}:c),p=[];for(const e of new Set(o.tags))p.push("cm-lsp-diagnostic-tag-"+ue[e]);n.push({from:Math.min(d,e.state.doc.length),to:Math.min(u,e.state.doc.length),severity:r,message:o.message,source:o.source,markClass:p.join(" ")})}return n}),{delay:n.composite.debounceDelay||250,needsRefresh:e=>e.startState.field(this._invalidationCounter)!==e.state.field(this._invalidationCounter)}),this._invalidationCounter];return n.composite.gutter&&i.push((0,It.Q2)()),Xe.EditorExtensionRegistry.createImmutableExtension(i)}})}_reconfigureTheme(){const e=getComputedStyle(document.body),t=new Lt.V({".cm-editor .cm-lintRange-error":{backgroundImage:Ot(e.getPropertyValue("--jp-editor-mirror-lsp-diagnostic-error-decoration-color"))},".cm-editor .cm-lintRange-warning":{backgroundImage:Ot(e.getPropertyValue("--jp-editor-mirror-lsp-diagnostic-warning-decoration-color"))},".cm-editor .cm-lintRange-info":{backgroundImage:Ot(e.getPropertyValue("--jp-editor-mirror-lsp-diagnostic-information-decoration-color"))},".cm-editor .cm-lintRange-hint":{backgroundImage:Ot(e.getPropertyValue("--jp-editor-mirror-lsp-diagnostic-hint-decoration-color"))}});this._styleElement.innerHTML=t.getRules()}clearDocumentDiagnostics(e,t){this.getDiagnosticsDB(e).set(t,[])}getDiagnosticsDB(e){return this._diagnosticsDatabases.has(e)||this._diagnosticsDatabases.set(e,new yt),this._diagnosticsDatabases.get(e)}diagnosticsByRange(e){const t=new Map,n=new Map;e.forEach((e=>{let i=e.range,o=function(e){return e.start.line+","+e.start.character+","+e.end.line+","+e.end.character}(i);t.set(o,i),n.has(o)?n.get(o).push(e):n.set(o,[e])}));let i=new Map;return n.forEach(((e,n)=>{let o=t.get(n);i.set(o,e)})),i}get defaultSeverity(){return de[this.settings.composite.defaultSeverity]}filterDiagnostics(e){const t=new Set(this.settings.composite.ignoreCodes),n=new Set(this.settings.composite.ignoreSeverities.map((e=>de[e]))),i=this.settings.composite.ignoreMessagesPatterns.map((e=>new RegExp(e)));return e.filter((e=>{let o=e.code;if(null!=o&&t.has(o.toString()))return!1;let r=e.severity;if(r&&n.has(r))return!1;let s=e.message;return!s||!i.some((e=>e.test(s)))}))}setDiagnostics(e,t,n){let i=[];this.diagnosticsByRange(this.filterDiagnostics(e.diagnostics)).forEach(((e,n)=>{const o=ye.lsp_to_cm(n.start),r=ye.lsp_to_cm(n.end),s=t.lastVirtualLine-t.blankLinesBetweenCells;if(o.line>s)return void this.console.log(`Out of range diagnostic (${o.line} line > ${s}) was skipped `,e);{let n=t.lastLine;if(o.line==s&&o.ch>n.length)return void this.console.log(`Out of range diagnostic (${o.ch} character > ${n.length} at line ${s}) was skipped `,e)}if(t.virtualLines.get(o.line).skipInspect.includes(t.idPath))return void this.console.log("Ignoring inspections silenced for this document:",e,t.idPath,o.line);const a=t.getEditorAtVirtualLine(o),l=t.transformVirtualToEditor(o);let c;if(null!==l){try{c=t.transformVirtualToEditor(r)}catch(e){this.console.warn("Malformed range for diagnostic",r),c={...l,ch:l.ch+1}}if(null!==c)for(let t of e)i.push({diagnostic:t,editorAccessor:a,range:{start:l,end:c}});else this.console.warn("End in editor could not be be determined for",e)}else this.console.warn("Start in editor could not be be determined for",e)}));const o=this.getDiagnosticsDB(n),r=o.get(t),s=new Set(null==r?void 0:r.map((e=>e.editorAccessor.getEditor()))),a=new Set(null==i?void 0:i.map((e=>e.editorAccessor.getEditor())));o.set(t,i);for(const e of n.editors){const t=e.ceEditor.getEditor();t&&(a.has(t)||s.has(t))&&t.editor.dispatch({effects:this._invalidate.of()})}}refreshDiagnostics(){this._lastResponse&&this.setDiagnostics(this._lastResponse,this._lastDocument,this._lastAdapter),Tt.update()}}var zt;!function(e){e.id=r+":diagnostics"}(Nt||(Nt={})),function(e){e.showPanel="lsp:show-diagnostics-panel"}(zt||(zt={}));const Ht={id:Nt.id,requires:[a.ILSPFeatureManager,m.ISettingRegistry,a.ILSPDocumentConnectionManager,Xe.IEditorExtensionRegistry],optional:[Ye.ILayoutRestorer,V.IThemeManager,V.ICommandPalette,A.ITranslator],autoStart:!0,activate:async(e,t,n,i,o,r,s,a,l)=>{const c=(l||A.nullTranslator).load("jupyterlab_lsp"),d=new we(n,Nt.id);await d.ready;const u=new Nt({settings:d,connectionManager:i,shell:e.shell,editorExtensionRegistry:o,themeManager:s,trans:c});if(!d.composite.disable){t.register(u);const n=new Qe({app:e,connectionManager:i}),o="lsp-diagnostics",s=new V.WidgetTracker({namespace:o});e.commands.addCommand(zt.showPanel,{execute:async()=>{const t=n.getContext();let i=null;t?(u.switchDiagnosticsPanelSource(t.adapter),i=t.adapter.widgetId):console.warn("Could not get context"),Tt.isRegistered||(Tt.trans=c,Tt.register(e));const o=Tt.widget;o.isAttached||(s.add(o),e.shell.add(o,"main",{ref:i,mode:"split-bottom"})),e.shell.activateById(o.id),s.save(o)},label:c.__("Show diagnostics panel"),icon:St,isEnabled:()=>"JupyterLab Classic"!=e.name}),e.contextMenu.addItem({selector:".jp-Notebook .jp-CodeCell .jp-Editor",command:zt.showPanel,rank:10}),e.contextMenu.addItem({selector:".jp-FileEditor",command:zt.showPanel,rank:0}),a&&a.addItem({command:zt.showPanel,category:c.__("Language Server Protocol")}),r&&r.restore(s,{command:zt.showPanel,name:e=>"listing"})}return u}};var Vt,qt=n(6797);function $t(e){const t=++Vt.specCounter,n=Object.fromEntries(Object.entries(e).map((([e,t])=>[e,tt.Decoration.mark({...t,_id:Vt.specCounter})]))),i=Pt.StateEffect.define({map:({from:e,to:t,kind:n},i)=>({from:i.mapPos(e),to:i.mapPos(t),kind:n})}),o=Pt.StateEffect.define(),r=Pt.StateField.define({create:()=>tt.Decoration.none,update(e,r){e=e.map(r.changes);for(let s of r.effects)s.is(i)?e=e.update({add:[n[s.value.kind].range(Math.min(s.value.from,r.newDoc.length),Math.min(s.value.to,r.newDoc.length))]}):s.is(o)&&(e=e.update({filter:(e,n,i)=>i.spec._id!==t}));return e},provide:e=>tt.EditorView.decorations.from(e)}),s=new Set;return{putMarks(e,t){const n=t.map((e=>i.of(e)));e.state.field(r,!1)||n.push(Pt.StateEffect.appendConfig.of([r])),e.dispatch({effects:n}),s.add(e)},clearAllMarks(){for(let e of s)this.clearEditorMarks(e);s.clear()},clearEditorMarks(e){const t=[o.of(null)];e.dispatch({effects:t})}}}!function(e){e.specCounter=0}(Vt||(Vt={})),new v.LabIcon({name:"lsp:highlight",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">\n  <g class="jp-icon3 jp-icon-selectable" fill="#616161" shape-rendering="geometricPrecision">\n    <path d="M18.5 1.15c-.53 0-1.04.19-1.43.58l-5.81 5.82 5.65 5.65 5.82-5.81c.77-.78.77-2.04 0-2.83l-2.84-2.83c-.39-.39-.89-.58-1.39-.58M10.3 8.5l-5.96 5.96c-.78.78-.78 2.04.02 2.85C3.14 18.54 1.9 19.77.67 21h5.66l.86-.86c.78.76 2.03.75 2.81-.02l5.95-5.96"/>\n  </g>\n</svg>\n'});class Wt extends be{constructor(e){super(e),this.capabilities={textDocument:{documentHighlight:{dynamicRegistration:!0}}},this.id=Wt.id,this.console=(new Le).scope("Highlights"),this._lastToken=null,this.requestHighlights=async(e,t)=>{const n=this.connectionManager.connections.get(e.uri);return n.isReady&&n.serverCapabilities.documentHighlightProvider?(this._versionSent=e.documentInfo.version,await n.clientRequests["textDocument/documentHighlight"].request({textDocument:{uri:e.documentInfo.uri},position:{line:t.line,character:t.ch}})):null},this.settings=e.settings;const t=e.connectionManager;this.markManager=$t({[he.Text]:{class:"cm-lsp-highlight-Text"},[he.Read]:{class:"cm-lsp-highlight-Read"},[he.Write]:{class:"cm-lsp-highlight-Write"}}),this._debouncedGetHighlight=this.createDebouncer(),this.settings.changed.connect((()=>{this._debouncedGetHighlight=this.createDebouncer()})),e.editorExtensionRegistry.addExtension({name:"lsp:highlights",factory:e=>{const n=tt.EditorView.updateListener.of((e=>{if(e.docChanged||e.selectionSet||e.focusChanged){const n=[...t.adapters.values()].find((t=>t.widget.node.contains(e.view.dom)));if(!n)return void this.console.warn("Adapter not found");this.onCursorActivity(n).catch(this.console.warn)}})),i=tt.EditorView.domEventHandlers({blur:(e,t)=>{this.onBlur(t)},focus:e=>{const n=[...t.adapters.values()].find((t=>t.widget.node.contains(e.currentTarget)));n?this.onCursorActivity(n).catch(this.console.warn):this.console.warn("Adapter not found")},keydown:e=>{const n=[...t.adapters.values()].find((t=>t.widget.node.contains(e.currentTarget)));n?this.onCursorActivity(n).catch(this.console.warn):this.console.warn("Adapter not found")}});return Xe.EditorExtensionRegistry.createImmutableExtension([n,i])}})}onBlur(e){this.settings.composite.removeOnBlur&&setTimeout((()=>{this.markManager.clearEditorMarks(e),this._lastToken=null}),0)}handleHighlight(e,t,n){if(this.markManager.clearAllMarks(),!e)return;const i=new Map;for(let o of e){let e=Me(t,o.range,null,n);const r=e.editor;let s=i.get(r);s||(s=[],i.set(r,s)),s.push({kind:o.kind||he.Text,from:r.getOffsetAt(ye.cm_to_ce(e.start)),to:r.getOffsetAt(ye.cm_to_ce(e.end))})}for(const[e,t]of i.entries()){const n=e.editor;this.markManager.putMarks(n,t)}}createDebouncer(){return new qt.Debouncer(this.requestHighlights,this.settings.composite.debouncerDelay)}async onCursorActivity(e){if(!e.virtualDocument)return void this.console.log("virtualDocument not ready on adapter");await e.virtualDocument.updateManager.updateDone;const t=e.activeEditor,n=t.getEditor(),i=n.getCursorPosition(),o=ye.ce_to_cm(i),r=je(e,t,o);if(!r)return void this.console.debug("Root position not available");const s=_e(e,r);if(!s.documentInfo)return void this.console.debug("Root document lacks document info");const a=n.getOffsetAt(ye.cm_to_ce(o)),l=n.getTokenAt(a);if(this._lastToken&&l.value===this._lastToken.token.value&&e===this._lastToken.adapter&&""!==l.value)this.console.log("not requesting highlights (token did not change)",l);else try{const t=ke(e,r);this._virtualPosition=t;const[n]=await Promise.all([this._debouncedGetHighlight.invoke(s,t),async()=>{this.markManager.clearAllMarks(),this._lastToken=null}]);if(s.isDisposed)return;let i=s.documentInfo.version;if(i!==this._versionSent)return void this.console.log("skipping highlights response delayed by "+(i-this._versionSent)+" document versions");if(t!==this._virtualPosition)return void this.console.log("skipping highlights response: cursor moved since it was requested");this.handleHighlight(n,e,s),this._lastToken={token:l,adapter:e}}catch(e){this.console.warn("Could not get highlights:",e)}}}!function(e){e.id=r+":highlights"}(Wt||(Wt={}));const Ut={id:Wt.id,requires:[a.ILSPFeatureManager,m.ISettingRegistry,Xe.IEditorExtensionRegistry,a.ILSPDocumentConnectionManager],autoStart:!0,activate:async(e,t,n,i,o)=>{const r=new Qe({app:e,connectionManager:o}),s=new we(n,Wt.id);if(await s.ready,s.composite.disable)return;const a=new Wt({settings:s,editorExtensionRegistry:i,connectionManager:o,contextAssembler:r});t.register(a)}};var Gt=n(4955);class Zt extends Gt.Tooltip{constructor(e){super(e),this.options=e,this._setGeometry()}setBundle(e){const t=new Ee.MimeModel({data:e});this._content.renderModel(t).then((()=>this._setGeometry())).catch(console.warn)}handleEvent(e){if(this.isHidden||this.isDisposed)return;const{node:t}=this,n=e.target;switch(e.type){case"keydown":{const i=e.keyCode;if(t.contains(n)||!this.options.hideOnKeyPress&&27!=i&&8!=i)return;this.dispose();break}default:super.handleEvent(e)}}_setGeometry(){const e=this._editor,t=null==this.options.position?e.getCursorPosition():this.options.position;let n;if(this.options.alignment){const i=e.getOffsetAt(t),o=e.getLine(t.line);if(!o)return;switch(this.options.alignment){case"start":{const t=o.substring(0,i).split(/\W+/),r=t[t.length-1],s=r?i-r.length:i;n=e.getPositionAt(s);break}case"end":{const t=o.substring(0,i).split(/\W+/),r=t[t.length-1],s=r?i-r.length:i;n=e.getPositionAt(s);break}}}else n=t;if(!n)return;const i=e.getCoordinateForPosition(n),o=window.getComputedStyle(this.node),r=parseInt(o.paddingLeft,10)||0,s=e.host.closest(".jp-MainAreaWidget > .lm-Widget")||e.host;V.HoverBox.setGeometry({anchor:i,host:s,maxHeight:250,minHeight:20,node:this.node,offset:{horizontal:-1*r},privilege:this.options.privilege||"below",style:o,outOfViewDisplay:{left:"stick-inside",right:"stick-outside",top:"stick-outside",bottom:"stick-inside"}})}setPosition(e){this.options.position=e,this._setGeometry()}}function Jt(e){return"plaintext"===e.kind?{"text/plain":e.value}:{"text/markdown":e.value}}class Kt{constructor(e){this.rendermimeRegistry=e,this.currentTooltip=null}create(e){this.remove(),this.currentOptions=e;let{markup:t,position:n,adapter:i}=e,o=i.widget;const r=Jt(t),s=new Zt({...e.tooltip||{},anchor:o.content,bundle:r,editor:e.ceEditor,rendermime:this.rendermimeRegistry,position:ye.cm_to_ce(n)});return s.addClass("lsp-tooltip"),e.className&&s.addClass(e.className),et.Widget.attach(s,document.body),this.currentTooltip=s,s}showOrCreate(e){const t=this.currentOptions&&(0,a.isEqual)(this.currentOptions.position,e.position),n=this.currentOptions&&this.currentOptions.markup.value===e.markup.value&&this.currentOptions.markup.kind===e.markup.kind;return null!==this.currentTooltip&&!this.currentTooltip.isDisposed&&this.currentOptions&&this.currentOptions.adapter===e.adapter&&(t||n)&&this.currentOptions.ceEditor===e.ceEditor&&this.currentOptions.id===e.id?(n||(this.currentOptions.markup=e.markup,this.currentTooltip.setBundle(Jt(e.markup))),t||this.currentTooltip.setPosition(ye.cm_to_ce(e.position)),this.show(),this.currentTooltip):(this.remove(),this.create(e))}get position(){return this.currentOptions.position}isShown(e){var t;return(!e||!this.currentOptions||(null===(t=this.currentOptions)||void 0===t?void 0:t.id)===e)&&null!==this.currentTooltip&&!this.currentTooltip.isDisposed&&this.currentTooltip.isVisible}hide(){null!==this.currentTooltip&&this.currentTooltip.hide()}show(){null!==this.currentTooltip&&this.currentTooltip.show()}remove(){null!==this.currentTooltip&&(this.currentTooltip.dispose(),this.currentTooltip=null)}}new v.LabIcon({name:"lsp:hover",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">\n  <g class="jp-icon3 jp-icon-selectable" fill="#616161" shape-rendering="geometricPrecision">\n    <path d="M11 18h2v-2h-2v2m1-12a4 4 0 00-4 4h2a2 2 0 012-2 2 2 0 012 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5a4 4 0 00-4-4M5 3h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2z"/>\n  </g>\n</svg>\n'});class Yt{get data(){return this._data}constructor(e){this.maxSize=e,this._data=[]}store(e){const t=this._data.findIndex((t=>t.document===e.document&&(0,a.isEqual)(t.editorRange.start,e.editorRange.start)&&(0,a.isEqual)(t.editorRange.end,e.editorRange.end)&&t.editorRange.editor===e.editorRange.editor));-1===t?(this._data.length>=this.maxSize&&this._data.shift(),this._data.push(e)):this._data[t]=e}clean(){this._data=[]}}function Xt(e){return"string"==typeof e?{kind:"markdown",value:e}:{kind:"markdown",value:"```"+e.language+"\n"+e.value+"\n```"}}class Qt extends be{constructor(e){super(e),this.capabilities={textDocument:{hover:{dynamicRegistration:!0,contentFormat:["markdown","plaintext"]}}},this.id=Qt.id,this.console=(new Le).scope("Hover"),this.lastHoverCharacter=null,this.hasMarker=!1,this._previousHoverRequest=null,this.onKeyDown=(e,t)=>{if(at(e,this.modifierKey)&&null!==this.lastHoverCharacter){if(this.tooltip&&this.tooltip.isVisible&&!this.tooltip.isDisposed)return;const n=_e(t,this.lastHoverCharacter);let i=this.restoreFromCache(n,this.virtualPosition);if(null==i)return;e.stopPropagation(),this.handleResponse(t,i,this.lastHoverCharacter,!0)}},this.onMouseLeave=e=>{this.removeRangeHighlight(),this.maybeHideTooltip(e)},this.getHover=async(e,t,n)=>{const i=this.connectionManager.connections.get(e.uri);if(!i.isReady||!i.serverCapabilities.hoverProvider)return null;let o=await i.clientRequests["textDocument/hover"].request({textDocument:{uri:e.documentInfo.uri},position:{line:t.line,character:t.ch}});if(null==o)return null;if(void 0!==o.range)return o;const r=this._getEditorRange(n.adapter,o,n.token,n.editor,e);return this._addRange(n.adapter,o,r,n.editorAccessor)},this.handleResponse=(e,t,n,i)=>{let o=t.response;if(this.lastHoverResponse!=o){this.removeRangeHighlight();const e=t.editorRange,n=e.editor.editor,i=e.editor.getOffsetAt(ye.cm_to_ce(e.start)),o=e.editor.getOffsetAt(ye.cm_to_ce(e.end));this.markManager.putMarks(n,[{from:i,to:o,kind:"hover"}]),this.hasMarker=!0}if(this.lastHoverResponse=o,i){const i=Qt.getMarkupForHover(o);let r=Se(e,n);return this.tooltip=this.tooltipManager.showOrCreate({markup:i,position:r,ceEditor:t.ceEditor,adapter:e,className:"lsp-hover"}),!0}return!1},this.updateUnderlineAndTooltip=(e,t)=>{try{return this._updateUnderlineAndTooltip(e,t)}catch(e){return void this.console.warn(e)}},this.removeRangeHighlight=()=>{this.hasMarker&&(this.markManager.clearAllMarks(),this.hasMarker=!1,this.lastHoverResponse=null,this.lastHoverCharacter=null)},this.settings=e.settings,this.tooltipManager=new Kt(e.renderMimeRegistry),this.contextAssembler=e.contextAssembler,this.cache=new Yt(10);const t=e.connectionManager;this.markManager=$t({hover:{class:"cm-lsp-hover-available"}}),e.editorExtensionRegistry.addExtension({name:"lsp:hover",factory:e=>{const n=tt.EditorView.updateListener.of((e=>{e.docChanged&&this.afterChange()})),i=tt.EditorView.domEventHandlers({mousemove:e=>{var n;const i=[...t.adapters.values()].find((t=>t.widget.node.contains(e.target)));i?null===(n=this.updateUnderlineAndTooltip(e,i))||void 0===n||n.then((t=>{t||this.maybeHideTooltip(e)})).catch(this.console.warn):this.console.warn("Adapter not found")},mouseleave:e=>{this.onMouseLeave(e)},keydown:e=>{const n=[...t.adapters.values()].find((t=>t.widget.node.contains(e.currentTarget)));n?this.onKeyDown(e,n):this.console.warn("Adapter not found")}});return Xe.EditorExtensionRegistry.createImmutableExtension([i,n])}}),this.debouncedGetHover=this.createThrottler(),this.settings.changed.connect((()=>{this.cache.maxSize=this.settings.composite.cacheSize,this.debouncedGetHover=this.createThrottler()}))}createThrottler(){return new qt.Throttler(this.getHover,{limit:this.settings.composite.throttlerDelay||0,edge:"trailing"})}get modifierKey(){return this.settings.composite.modifierKey}get isHoverAutomatic(){return this.settings.composite.autoActivate}restoreFromCache(e,t){const{line:n,ch:i}=t,o=this.cache.data.filter((t=>{if(t.document!==e)return!1;let o=t.response.range;return a.ProtocolCoordinates.isWithinRange({line:n,character:i},o)}));return o.length>1&&this.console.warn("Potential hover cache malfunction: ",t,o),0!=o.length?o[0]:null}maybeHideTooltip(e){void 0===this.tooltip||function(e,t,n=50){const i="mouseleave"===t.type?t.relatedTarget:t.target;if(e===i||e.contains(i))return!0;const o=e.getBoundingClientRect();return!(t.x<o.left-n||t.x>o.right+n||t.y<o.top-n||t.y>o.bottom+n)}(this.tooltip.node,e)||this.tooltip.dispose()}afterChange(){this.cache.clean(),this.lastHoverCharacter=null,this.removeRangeHighlight()}static getMarkupForHover(e){let t=e.contents;if("string"==typeof t&&(t=[t]),!Array.isArray(t))return t;let n=t.map(Xt);return n.every((e=>"plaintext"==e.kind))?{kind:"plaintext",value:n.map((e=>e.value)).join("\n")}:{kind:"markdown",value:n.map((e=>e.value)).join("\n\n")}}isTokenEmpty(e){return 0===e.value.length}isEventInsideVisible(e){return null!=e.target.closest(".cm-scroller")}isResponseUseful(e){return e&&e.contents&&!(Array.isArray(e.contents)&&0===e.contents.length)}async _updateUnderlineAndTooltip(e,t){const n=e.target;if(null==n)return this.removeRangeHighlight(),!1;const i=this.isHoverAutomatic||at(e,this.modifierKey);if(!t)return this.removeRangeHighlight(),!1;const o=this.contextAssembler.editorFromNode(t,n);o||this.console.warn("Editor accessor not found from node, falling back to activeEditor");const r=o||t.activeEditor;if(!r)return this.removeRangeHighlight(),this.console.warn("Could not find editor accessor"),!1;const s=this.contextAssembler.positionFromCoordinates(e.clientX,e.clientY,t,r);if(null==s)return this.removeRangeHighlight(),!1;const l=r.getEditor();if(!l)return this.console.warn("Editor not available from accessor"),this.removeRangeHighlight(),!1;const c=Se(t,s),d=l.getOffsetAt(ye.cm_to_ce(c)),u=l.getTokenAt(d),p=_e(t,s);if(this.isTokenEmpty(u)||!this.isEventInsideVisible(e))return this.removeRangeHighlight(),!1;if(this.lastHoverCharacter&&(0,a.isEqual)(s,this.lastHoverCharacter))return!0;{let e=ke(t,s);this.virtualPosition=e,this.lastHoverCharacter=s,this._previousHoverRequest&&await Promise.race([this._previousHoverRequest,new Promise((e=>setTimeout(e,1e3)))]);let n=this.restoreFromCache(p,e),o=this.settings.composite.delay;if(null==n){const i=this.debouncedGetHover.invoke(p,e,{adapter:t,token:u,editor:l,editorAccessor:r});this._previousHoverRequest=i;let s=await i;if(this._previousHoverRequest===i&&(this._previousHoverRequest=null),!(s&&s.range&&a.ProtocolCoordinates.isWithinRange({line:e.line,character:e.ch},s.range)&&this.isResponseUseful(s)))return this.removeRangeHighlight(),!1;n={response:s,document:p,editorRange:this._getEditorRange(t,s,u,l,p),ceEditor:l},this.cache.store(n),o=Math.max(0,this.settings.composite.delay-this.settings.composite.throttlerDelay)}return this.isHoverAutomatic&&await new Promise((e=>setTimeout(e,o))),this.handleResponse(t,n,s,i)}}remove(){this.cache.clean(),this.removeRangeHighlight(),this.debouncedGetHover.dispose()}_getEditorRange(e,t,n,i,o){if(void 0!==t.range)return Me(e,t.range,i,o);const r=i.getPositionAt(n.offset),s=i.getPositionAt(n.offset+n.value.length);if(!r||!s)throw Error("Could not reconstruct editor range: start or end of token in editor do not resolve to a position");return{start:ye.ce_to_cm(r),end:ye.ce_to_cm(s),editor:i}}_addRange(e,t,n,i){return{...t,range:{start:ye.cm_to_lsp(ke(e,je(e,i,n.start))),end:ye.cm_to_lsp(ke(e,je(e,i,n.end)))}}}}!function(e){e.id=r+":hover"}(Qt||(Qt={}));const en={id:Qt.id,requires:[a.ILSPFeatureManager,m.ISettingRegistry,Ee.IRenderMimeRegistry,Xe.IEditorExtensionRegistry,a.ILSPDocumentConnectionManager],autoStart:!0,activate:async(e,t,n,i,o,r)=>{const s=new Qe({app:e,connectionManager:r}),a=new we(n,Qt.id);if(await a.ready,a.composite.disable)return;const l=new Qt({settings:a,renderMimeRegistry:i,editorExtensionRegistry:o,connectionManager:r,contextAssembler:s});t.register(l)}};function tn(e,t){return(0,a.offsetAtPosition)(ye.lsp_to_ce(e),t)}class nn{constructor(e,t){this.virtualDocument=e,this.adapter=t}async applyEdit(e){let t=this.virtualDocument.documentInfo.uri,n=e.documentChanges?e.documentChanges.map((e=>e)):function(e){let t=[];for(let n of Object.keys(e))t.push({textDocument:{uri:n},edits:e[n]});return t}(e.changes),i=0,o=0,r=!1,s=[];for(let e of n){let n=e.textDocument.uri;if(ct(n,t)){let t;if(r=1===e.edits.length&&this._isWholeDocumentEdit(e.edits[0]),r)t=e.edits[0],i+=1;else{i=0;let n=this.virtualDocument.value,o=n.split("\n"),r=new Map;for(let t of e.edits){let e=tn(t.range.start,o);r.has(e)?console.warn("Edits should not overlap, ignoring an overlapping edit"):(r.set(e,t),i+=1)}let s=new lt((()=>[])),a="",l=0,c=0,d=0,u=[...r.keys()].sort(((e,t)=>e-t));for(let e of u){let t=r.get(e),i=n.slice(l,e);for(let e=0;e<i.split("\n").length;e++)s.getOrCreate(c).push(d),c+=1,d+=1;a+=i+t.newText;let u=tn(t.range.end,o),p=n.slice(e,u);for(let e=0;e<t.newText.split("\n").length;e++)e<p.length&&(c+=1),d+=1,s.getOrCreate(c).push(d);l=u}a+=n.slice(l,n.length),t={range:{start:{line:0,character:0},end:{line:o.length-1,character:o[o.length-1].length}},newText:a},console.assert(this._isWholeDocumentEdit(t))}o=this._applySingleEdit(t)}else s.push(`Workspace-wide edits not implemented: ${n} != ${t}`)}const a=n.every((e=>0===e.edits.length));return{appliedChanges:i,modifiedCells:o,wasGranular:!r&&!a,errors:s}}_isWholeDocumentEdit(e){let t=this.virtualDocument.value,n=t.split("\n"),i=e.range,o=ye.lsp_to_ce;return 0===(0,a.offsetAtPosition)(o(i.start),n)&&(0,a.offsetAtPosition)(o(i.end),n)===t.length}_replaceFragment(e,t,n,i,o,r,s=!1){let l=this.virtualDocument,c=e.split("\n").slice(n.line-o.line,i.line-o.line).join("\n");c.endsWith("\n")&&(c=c.slice(0,-1));const d=t.getEditor();if(!d)throw Error("Editor is not accessible");const u=d.model;let p=u.sharedModel.source,{lines:g}=l.prepareCodeBlock({value:p,ceEditor:t,type:"code"}),h=g.join("\n");if(s){let t=ye.cm_to_ce,n=(0,a.offsetAtPosition)(t(o),g),i=(0,a.offsetAtPosition)(t(r),g);c=h.slice(0,n)+e+h.slice(i)}if(h===c)return 0;let m=l.decodeCodeBlock(c);const f=d.getCursorPosition();u.sharedModel.updateSource(d.getOffsetAt({line:0,column:0}),h.length,m);try{d.setSelection({start:f,end:f})}catch(e){console.log("Could not place the cursor back",e)}return 1}_applySingleEdit(e){let t=this.virtualDocument,n=0,i=ye.lsp_to_cm(e.range.start),o=ye.lsp_to_cm(e.range.end),r=t.getEditorAtVirtualLine(i);if(r!==t.getEditorAtVirtualLine(o)){let s=r,a=i,l={...i},c=i.line,d=!1;for(;c<=o.line;){c++;let r=t.getEditorAtVirtualLine({line:c,ch:0});r===s?(l.line=c,l.ch=0,d=!1):(n+=this._replaceFragment(e.newText,s,a,l,i,o),d=!0,a={line:c,ch:0},l={line:c,ch:0},s=r)}d||(n+=this._replaceFragment(e.newText,s,a,l,i,o))}else n+=this._replaceFragment(e.newText,r,i,o,i,o);return n}}const on=new o.Token(r+":IDiagnosticsFeature"),rn=new v.LabIcon({name:"lsp:rename",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">\n  <g class="jp-icon3 jp-icon-selectable" fill="#616161" shape-rendering="geometricPrecision">\n    <path d="M17 7h5v10h-5v2a1 1 0 001 1h2v2h-2.5c-.55 0-1.5-.45-1.5-1 0 .55-.95 1-1.5 1H12v-2h2a1 1 0 001-1V5a1 1 0 00-1-1h-2V2h2.5c.55 0 1.5.45 1.5 1 0-.55.95-1 1.5-1H20v2h-2a1 1 0 00-1 1v2M2 7h11v2H4v6h9v2H2V7m18 8V9h-3v6h3z"/>\n  </g>\n</svg>\n'}),sn=r+":rename";class an extends be{constructor(e){super(e),this.id=an.id,this.capabilities={textDocument:{rename:{prepareSupport:!1,honorsChangeAnnotations:!1}}},this.console=(new Le).scope("Rename"),this._trans=e.trans}async handleRename(e,t,n,i,o){let r;const s=new nn(o,i);try{r=await s.applyEdit(e)}catch(e){return void V.Notification.emit(this._trans.__("Rename failed: %1",e),"error")}try{let e;const o=this._trans.__("%1 to %2",t,n);let s="success";0===r.appliedChanges?(e=this._trans.__("Could not rename %1 - consult the language server documentation",o),s="warning"):e=r.wasGranular?this._trans._n("Renamed %2 in %3 place","Renamed %2 in %3 places",r.appliedChanges,o,r.appliedChanges):i.hasMultipleEditors?this._trans._n("Renamed %2 in %3 cell","Renamed %2 in %3 cells",r.modifiedCells,o,r.modifiedCells):this._trans.__("Renamed %1",o),0!==r.errors.length&&(e+=this._trans.__(" with errors: %1",r.errors),s="error"),V.Notification.emit(e,s,{autoClose:1e3*("error"===s?5:3)})}catch(e){this.console.warn(e)}return r}}var ln;!function(e){e.id=sn}(an||(an={})),function(e){e.renameSymbol="lsp:rename-symbol"}(ln||(ln={}));const cn={id:sn,requires:[a.ILSPFeatureManager,m.ISettingRegistry,a.ILSPDocumentConnectionManager],optional:[V.ICommandPalette,on,A.ITranslator],autoStart:!0,activate:async(e,t,n,i,o,r,s)=>{const a=(s||A.nullTranslator).load("jupyterlab_lsp"),l=new we(n,an.id);if(await l.ready,l.composite.disable)return;const c=new an({trans:a,connectionManager:i});t.register(c);const d=new Qe({app:e,connectionManager:i});e.commands.addCommand(ln.renameSymbol,{execute:async()=>{const e=d.getContext();if(!e)return;const{adapter:t,connection:n,virtualPosition:i,rootPosition:o,document:s}=e,l=xe(t,o),u=null==l?void 0:l.getEditor();if(!u)return void console.log("Could not rename - no editor");const p=Se(t,o),g=u.getOffsetAt(ye.cm_to_ce(p));let h=u.getTokenAt(g).value,m=e=>{let n="";r&&(n=function(e,t,n,i){let o=!1;try{o=e.message.includes("IndexError")}catch(e){return null}if(!o)return null;let r=(n.getDiagnosticsDB(t).all||[]).filter((e=>e.diagnostic.message.includes("invalid syntax")||e.diagnostic.message.includes("SyntaxError")||e.diagnostic.message.includes("IndentationError")));if(0===r.length)return null;let s=[...new Set(r.map((e=>{let n=e.diagnostic.message,o=e.range.start;if(t.hasMultipleEditors){let r=t.editors.findIndex((t=>t.ceEditor===e.editorAccessor)),s=-1===r?"(?)":r+1;return i.__("%1 in cell %2 at line %3",n,s,o.line)}return i.__("%1 at line %2",n,o.line)})))].join(", ");return i.__("Syntax error(s) prevents rename: %1",s)}(e,t,r,a)),n?V.Notification.warning(n,{autoClose:3e3}):V.Notification.error(a.__("Rename failed: %1",e),{autoClose:5e3})};const f=await V.InputDialog.getText({title:a.__("Rename to"),text:h,okLabel:a.__("Rename"),cancelLabel:a.__("Cancel")});try{const e=f.value;if(1!=f.button.accept||null==e)return;V.Notification.info(a.__("Renaming %1 to %2",h,e),{autoClose:3e3});const o=await n.clientRequests["textDocument/rename"].request({position:{line:i.line,character:i.ch},textDocument:{uri:s.documentInfo.uri},newName:e});o?await c.handleRename(o,h,e,t,s):m(new Error("no edit from server"))}catch(e){m(e)}},isVisible:()=>{const e=d.getContext();if(!e)return!1;const{connection:t}=e;return null!=t&&t.isReady&&t.provides("renameProvider")},isEnabled:()=>!!d.isContextMenuOverToken(),label:a.__("Rename symbol"),icon:rn}),e.contextMenu.addItem({selector:".jp-Notebook .jp-CodeCell .jp-Editor",command:ln.renameSymbol,rank:10}),e.contextMenu.addItem({selector:".jp-FileEditor",command:ln.renameSymbol,rank:0}),o.addItem({command:ln.renameSymbol,category:a.__("Language Server Protocol")})}};var dn=n(7138);const un="signature",pn="lsp-signature-help";function gn(e){return"string"==typeof e?gt(e):"markdown"===e.kind?e.value:gt(e.value)}function hn(e,t,n){const i=document.createElement("pre"),o=document.createElement("code");i.appendChild(o),o.className=`language-${null==n?void 0:n.name}`;const r="string"==typeof t.label?t.label:e.slice(t.label[0],t.label[1]),s=e.indexOf(r),a=s+r.length;return n?function(e,t,n){const i=t.parser.parse(e);let o=0;(0,dn.highlightTree)(i,Xe.jupyterHighlightStyle,((t,i,r)=>{t>o&&n(e.slice(o,t),null,o,t),n(e.slice(t,i),r,t,i),o=i})),o!=i.length&&n(e.slice(o,i.length),null,o,i.length)}(e,n,((t,n,i,r)=>{let l=!1;if(i<=a&&s<=r){const t=Math.max(s,i),c=Math.min(r,a);if(t!=c){const s=e.slice(i,t),a=e.slice(t,c),d=e.slice(c,r),u=document.createElement("mark");n&&(u.className=n),u.appendChild(document.createTextNode(a)),o.appendChild(document.createTextNode(s)),o.appendChild(u),o.appendChild(document.createTextNode(d)),l=!0}}if(!l)if(n){const e=document.createElement("span");e.classList.add(n),e.textContent=t,o.appendChild(e)}else o.appendChild(document.createTextNode(t))})):o.innerText=e,i.outerHTML}class mn extends be{constructor(e){super(e),this.id=mn.id,this.capabilities={textDocument:{signatureHelp:{dynamicRegistration:!0,signatureInformation:{documentationFormat:["markdown","plaintext"]}}}},this.console=(new Le).scope("Signature"),this.settings=e.settings,this.tooltip=new Kt(e.renderMimeRegistry),this.languageRegistry=e.languageRegistry;const t=e.connectionManager;e.editorExtensionRegistry.addExtension({name:"lsp:codeSignature",factory:e=>{const n=tt.EditorView.updateListener.of((e=>{const n=[...t.adapters.values()].find((t=>t.widget.node.contains(e.view.contentDOM)));if(!n)return void this.console.log("No adapter, will not show signature");const i=n.activeEditor.getEditor();if(!i)return;const o=i.getCursorPosition(),r=ye.ce_to_cm(o);setTimeout((()=>{e.docChanged?this.afterChange(e.changes,n,r).catch(this.console.warn):e.selectionSet&&this.onCursorActivity(n,r).catch(this.console.warn)}),0)})),i=tt.EditorView.domEventHandlers({focus:()=>{},blur:e=>{this.onBlur(e)}});return Xe.EditorExtensionRegistry.createImmutableExtension([n,i])}})}get _closeCharacters(){return this.settings?this.settings.composite.closeCharacters:[]}onBlur(e){const t=e.relatedTarget;!this.isSignatureShown()||t&&null!==t.closest("."+pn)||this._removeTooltip()}async onCursorActivity(e,t){if(!this.isSignatureShown())return;const n=this.tooltip.position;t.line===n.line&&t.ch<n.ch?this._removeTooltip():await this._requestSignature(e,t,n)}getMarkupForSignatureHelp(e,t){let n=new Array;if(null!=e.activeSignature){if(!(e.activeSignature>=e.signatures.length)){const n=e.signatures[e.activeSignature];return{kind:"markdown",value:this.signatureToMarkdown(n,t,e.activeParameter)}}this.console.error("LSP server returned wrong number for activeSignature for: ",e)}return e.signatures.forEach((e=>{let i=this.signatureToMarkdown(e,t);n.push(i)})),{kind:"markdown",value:n.join("\n\n")}}signatureToMarkdown(e,t,n){return function(e,t,n,i,o,r=4){const s=void 0!==e.activeParameter?e.activeParameter:o;let a,l=e.label;e.parameters&&null!=s?s>e.parameters.length?(i.error("LSP server returned wrong number for activeSignature for: ",e),a="```"+(null==t?void 0:t.name)+"\n"+l+"\n```"):a=n(l,e.parameters[s],t):a="```"+(null==t?void 0:t.name)+"\n"+l+"\n```";let c="";if(e.documentation)if("string"==typeof e.documentation||"plaintext"===e.documentation.kind){const t="string"==typeof e.documentation?e.documentation:e.documentation.value;for(let n of t.split("\n"))n.trim()!==e.label.trim()&&(c+=gn(n)+"\n")}else"markdown"!==e.documentation.kind&&i.warn("Unknown MarkupContent kind:",e.documentation.kind),c+=e.documentation.value;else e.parameters&&(c+="\n\n"+e.parameters.filter((e=>e.documentation)).map((e=>"- "+gn(e.documentation))).join("\n"));if(c){const e=c.trim().split("\n");if(e.length>r){const t=function(e,t){const n=[];let i=!1;for(const o of e.slice(0,t+1)){if(""==o.trim()){i=!0;break}n.push(o)}const o=n.join("\n");return i&&-1===o.search(/[\\*#[\]<>_]/g)?{lead:o,remainder:e.slice(n.length+1).join("\n")}:null}(e,r);c=t?t.lead+"\n<details>\n"+t.remainder+"\n</details>":"<details>\n"+c+"\n</details>"}a+="\n\n"+c}else a+="\n";return a}(e,t,hn,this.console,n,this.settings.composite.maxLines)}_removeTooltip(){this.tooltip.remove()}_hideTooltip(){this.tooltip.hide()}handleSignature(e,t,n,i=null){var o,r,s;this.console.debug("Signature received",e);const l=t.virtualDocument,c=null!==(r=null===(o=this.connectionManager.connections.get(l.uri).serverCapabilities.signatureHelpProvider)||void 0===o?void 0:o.triggerCharacters)&&void 0!==r?r:[];if(null===e?this._removeTooltip():e&&this._hideTooltip(),!this.signatureCharacter||!e||!e.signatures.length)return e&&this._removeTooltip(),void this.console.debug("Ignoring signature response: cursor lost or response empty");const d=t.activeEditor,u=d.getEditor(),p=u.getCursorPosition(),g=ye.ce_to_cm(p),h=je(t,d,g);if(!h)return this.console.warn("Signature failed: could not map editor position to root position."),void this._removeTooltip();if(n.line!=h.line||h.ch<n.ch)return this.console.debug("Ignoring signature response: cursor has receded or changed line"),void this._removeTooltip();if(!u)return void this.console.debug("Ignoring signature response: the corresponding editor is not loaded");if(!u.hasFocus())return this.console.debug("Ignoring signature response: the corresponding editor lost focus"),void this._removeTooltip();const m=this.languageRegistry.findByMIME(u.model.mimeType),f=null===(s=null==m?void 0:m.support)||void 0===s?void 0:s.language;let A=this.getMarkupForSignatureHelp(e,f);if(this.console.debug("Signature will be shown",f,A,h,e),null===i){const e=u.model.sharedModel.getSource(),t=e.split("\n"),n=(0,a.offsetAtPosition)(ye.cm_to_ce(g),t),o=e.substring(0,n),r=Math.max(...c.map((e=>o.lastIndexOf(e))));i=-1!==r?ye.ce_to_cm((0,a.positionAtOffset)(r,t)):g}this.tooltip.showOrCreate({markup:A,position:i,id:un,ceEditor:u,adapter:t,className:pn,tooltip:{privilege:"forceAbove",alignment:void 0,hideOnKeyPress:!1}})}isSignatureShown(){return this.tooltip.isShown(un)}async afterChange(e,t,n){var i,o;const r=function(e){let t="";return e.iterChanges(((e,n,i,o,r)=>{t=r.sliceString(-1)})),t?t[0]:""}(e),s=this.isSignatureShown();let a=null;await t.updateFinished,s&&(a=this.tooltip.position,this._closeCharacters.includes(r)&&this._removeTooltip());const l=t.virtualDocument;if(!l)return void this.console.warn("Could not access virtual document");const c=this.connectionManager.connections.get(l.uri);c.isReady&&((null!==(o=null===(i=c.serverCapabilities.signatureHelpProvider)||void 0===i?void 0:i.triggerCharacters)&&void 0!==o?o:[]).includes(r)||s)&&await this._requestSignature(t,n,a)}async _requestSignature(e,t,n){const i=e.virtualDocument,o=this.connectionManager.connections.get(i.uri);if(!o.isReady||!o.serverCapabilities.signatureHelpProvider)return;const r=i.transformFromEditorToRoot(e.activeEditor,t);this.signatureCharacter=r;const s=ke(e,r),a=await o.clientRequests["textDocument/signatureHelp"].request({position:{line:s.line,character:s.ch},textDocument:{uri:i.documentInfo.uri}});return this.handleSignature(a,e,r,n)}}!function(e){e.id=r+":signature"}(mn||(mn={}));const fn={id:mn.id,requires:[a.ILSPFeatureManager,m.ISettingRegistry,Ee.IRenderMimeRegistry,Xe.IEditorExtensionRegistry,a.ILSPDocumentConnectionManager,Xe.IEditorLanguageRegistry],autoStart:!0,activate:async(e,t,n,i,o,r,s)=>{const a=new we(n,mn.id);if(await a.ready,a.composite.disable)return;const l=new mn({settings:a,connectionManager:r,renderMimeRegistry:i,editorExtensionRegistry:o,languageRegistry:s});t.register(l)}};var An=n(8730);new v.LabIcon({name:"lsp:syntax-highlighting",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">\n  <g class="jp-icon3 jp-icon-selectable" fill="#616161" shape-rendering="geometricPrecision">\n    <path d="M10.48 10.88l3.68-3.68-3.68-3.68L11.6 2.4l4.8 4.8-4.8 4.8-1.12-1.12m-4.16 0L2.64 7.2l3.68-3.68L5.2 2.4.4 7.2 5.2 12l1.12-1.12zM8.5 23.8l2.337-2.338-.025-.017a1.283 1.283 0 010-1.802l4.029-4.029 3.604 3.604-4.029 4.03a1.267 1.267 0 01-1.776.017l-.536.535H8.5m10.124-11.976a1.283 1.283 0 011.802 0l1.81 1.802a1.293 1.293 0 010 1.81l-2.805 2.796-3.604-3.604 2.797-2.805z"/>\n  </g>\n</svg>\n'});class vn extends be{constructor(e){super(e),this.options=e,this.id=vn.id,this.capabilities={},this.originalModes=new Map;const t=e.connectionManager,n=e.contextAssembler;e.editorExtensionRegistry.addExtension({name:"lsp:syntaxHighlighting",factory:e=>{let i=!1;const o=async(e,i=!0)=>{const o=[...t.adapters.values()].find((t=>t.widget.node.contains(e.view.contentDOM)));if(o){await o.ready;const t=n.editorFromNode(o,e.view.contentDOM);t||console.warn("Editor accessor not found from node, falling back to activeEditor");const r=t||o.activeEditor;if(!r)return void console.warn("No accessor");await this.updateMode(o,e.view,r,i)}},r=tt.EditorView.updateListener.of((async e=>{if(!e.docChanged){if(i)return;setTimeout((async()=>{await o(e,!1)}),2500),i=!0}await o(e)}));return Xe.EditorExtensionRegistry.createImmutableExtension([r])}})}getMode(e){const t=this.options.mimeTypeService.getMimeTypeByLanguage({name:e});if(t&&"text/plain"!=t)return this.options.languageRegistry.findByMIME(t)?Array.isArray(t)?t[0]:t:void 0}async updateMode(e,t,n,i=!0){const o=e.virtualDocument;if(!o)return;i&&await o.updateManager.updateDone;const r=n.getEditor(),s=r.state.doc.length,a=new Map;for(const e of o.getForeignDocuments(n))for(const[t,n]of e.entries()){if(n.editor.getEditor()!=r)continue;const e=(r.getOffsetAt(t.end)-r.getOffsetAt(t.start))/s,i=n.virtualDocument.language,o=this.getMode(i);if(void 0!==o&&e>this.options.settings.composite.foreignCodeThreshold){const e=r.model.mimeType;r.model.mimeType=o,a.set(r,e)}}if(!a.has(r)){const e=this.originalModes.get(r);e&&(r.model.mimeType=e)}for(const[e,t]of a)this.originalModes.has(e)||this.originalModes.set(e,t)}}!function(e){e.id=r+":syntax_highlighting"}(vn||(vn={}));const En={id:vn.id,requires:[a.ILSPFeatureManager,An.IEditorServices,m.ISettingRegistry,Xe.IEditorExtensionRegistry,Xe.IEditorLanguageRegistry,a.ILSPDocumentConnectionManager],autoStart:!0,activate:async(e,t,n,i,o,r,s)=>{const a=new we(i,vn.id);if(await a.ready,a.composite.disable)return;const l=new Qe({app:e,connectionManager:s}),c=new vn({settings:a,connectionManager:s,editorExtensionRegistry:o,mimeTypeService:n.mimeTypeService,languageRegistry:r,contextAssembler:l});t.register(c)}};class Cn{get registry(){return this._overrides}constructor(){this._overrides={}}register(e,t){t in this._overrides||(this._overrides[t]={cell:[],line:[]});let n=this._overrides[t];switch(e.scope){case"cell":n.cell.push(e);break;case"line":n.line.push(e)}}}const bn={id:d.name,requires:[],activate:e=>new Cn,provides:d,autoStart:!0};var wn=n(3849),yn=n.n(wn);const _n=e=>{const t=Object.entries(e.conflicts).map((([e,t])=>{if(0===Object.keys(t).length)return null;const n=Object.entries(t).map((([e,t])=>$().createElement("li",{key:"lsp-server-setting-conflict-"+e},$().createElement("code",null,e),": ",$().createElement("code",null,JSON.stringify(t)))));return $().createElement("div",{key:"lsp-server-setting-conflict-"+e},$().createElement("h4",null,e),$().createElement("ul",null,n))}));return $().createElement("div",null,e.trans.__("Multiple distinct values detected for:"),t,e.trans.__("Retaining the last value for each of the settings. Please remove the additional values in JSON Settings Editor."))};class xn extends $().Component{constructor(e){super(e),this.state={...e.formData},this._objectTemplate=kn({baseTemplate:this.props.registry.templates.ObjectFieldTemplate,objectSelector:e=>e.title===this.props.schema.title&&e.description===this.props.schema.description,trans:this.props.trans,languageServerManager:this.props.languageServerManager})}render(){this.props.schema.description=void 0;for(const e of Object.values(this.props.schema.properties))e.title="",e.description="";const e=this.props.validationErrors.map((e=>$().createElement("li",{key:"lsp-validation-error-"+e.instancePath},$().createElement("b",null,e.keyword),": ",e.message," in"," ",$().createElement("code",null,e.instancePath),e.params&&"allowedValues"in e.params?this.props.trans.__("allowed values: %1",JSON.stringify(e.params.allowedValues)):null))),t={...this.props.registry.templates,ObjectFieldTemplate:this._objectTemplate},n=Object.fromEntries(Object.entries(this.props.registry.fields).filter((e=>"language_servers"!=e[0])));return $().createElement("div",{className:"lsp-ServerSettings"},$().createElement("h3",{className:"lsp-ServerSettings-title"},this.props.trans.__("Language servers")),e.length>0?$().createElement("div",{className:"lsp-ServerSettings-validationError"},$().createElement("h4",null,this.props.trans.__("Validation of user settings for language server failed")),$().createElement("p",null,this.props.trans.__("Your language server settings do not follow current schema. The LSP configuration graphical interface will run in schema-free mode to enable you to continue using the current settings as-is (in case if the schema is outdated). If this is however an earlier configuration mistake (settings were not validated in earlier versions of jupyterlab-lsp), please correct the following validation errors in JSON Settings Editor, save, and reload application:")),$().createElement("ul",null,e)):null,$().createElement(v.FormComponent,{schema:this.props.schema,formData:this.state,validator:yn(),templates:t,uiSchema:this.props.uiSchema,fields:n,formContext:this.props.formContext,liveValidate:!0,idPrefix:this.props.idPrefix+"_language_servers",onChange:this._onChange.bind(this)}))}_onChange(e){e.errors.length&&console.error("Errors in form validation:",e.errors),this.setState(e.formData,(()=>this.props.onChange(this.state)))}}const kn=e=>{const t=t=>{if(!e.objectSelector(t)){const n=e.baseTemplate;return $().createElement(n,{...t})}const[n,i]=(0,q.useState)(t.properties.length>0?t.properties[0].name:null),o=e=>{const t=e.properties.filter((t=>e.filter(t.name)));return 0==t.length?null:$().createElement($().Fragment,null,$().createElement("h4",{className:"lsp-ServerSettings-list-group"},e.title),$().createElement("ul",null,t.map((e=>$().createElement("li",{onClick:()=>i(e.name),key:"tab-"+e.name,"data-tab":e.name,className:e.name===n?"lsp-selected":void 0},e.name)))))},r=e.languageServerManager,s=e.trans;return $().createElement("fieldset",{id:t.idSchema.$id},$().createElement("div",{className:"lsp-ServerSettings-tabs"},$().createElement("div",{className:"lsp-ServerSettings-list"},o({properties:t.properties,filter:e=>r.sessions.has(e),title:s.__("Available")}),o({properties:t.properties,filter:e=>!r.sessions.has(e),title:s.__("Not installed")})),$().createElement("div",{className:"lsp-ServerSettings-content"},r.specs.has(n)?(e=>{const t=e.workspace_configuration;return $().createElement("div",null,$().createElement("h4",{className:"lsp-ServerSettings-content-name"},e.display_name),$().createElement(Q,{specification:e}),t?$().createElement("p",{className:"lsp-ServerSettings-content-specOverrides"},s.__("Default values set programatically for: ")+Object.keys(t).join(", ")):null)})(r.specs.get(n)):null,t.properties.filter((e=>e.name===n)).map((e=>e.content)))))};return t.displayName="TabbedObjectTemplate",t};function Sn(e){if(null==e)return{};const t={},n=Object.entries(e).map((([e,t])=>[e,null==t?void 0:t.default])).filter((([e,t])=>void 0!==t));for(let[e,i]of n)t[e]=i;return t}class jn{constructor(e){this.options=e,e.schemaValidated.connect(((e,t)=>{this._validationErrors=t})),this._validationErrors=[]}renderForm(e){return(e=>$().createElement(xn,{...e}))({settingRegistry:this.options.settingRegistry,languageServerManager:this.options.languageServerManager,trans:this.options.trans,validationErrors:this._validationErrors,...e})}}class Mn{constructor(e){this.options=e,this._defaultsPopulated=new o.PromiseDelegate,this._schemaValidated=new Ce.Signal(this),this._defaults={},this._canonical=null,this._original=null,this._validationAttempt=0,this._lastValidation=null,this._lastUserServerSettings=null,this._lastUserServerSettingsDoted=null,this._validationErrors=[]}get schemaValidated(){return this._schemaValidated}get console(){return this.options.console}async setupSchemaTransform(e){const t=this.options.languageServerManager;await t.ready,this.options.settingRegistry.transform(e,{fetch:e=>(this._original||(this._original=o.JSONExt.deepCopy(e.schema)),this._canonical||(this._canonical=o.JSONExt.deepCopy(e.schema),this._populate(e,this._canonical),this._defaultsPopulated.resolve(void 0)),{data:e.data,id:e.id,raw:e.raw,schema:this._validationErrors.length?this._original:this._canonical,version:e.version})}),t.sessionsChanged.connect((async()=>{this._canonical=null,this._defaultsPopulated=new o.PromiseDelegate,await this.options.settingRegistry.reload(e)}))}_populate(e,t){const n=this.options.languageServerManager,i=t.definitions["language-server"],r={},s={},a=Sn(t.properties.language_servers.properties),l=t.properties.language_servers.default;for(let[e,t]of n.specs.entries()){if(""===e){this.console.warn("Empty server key - skipping transformation for",t);continue}const d=t.config_schema;if(!d){this.console.warn("No config schema - skipping transformation for",e);continue}if(!d.properties){this.console.warn("No properties in config schema - skipping transformation for",e);continue}n.sessions.has(e)?d.description=this.options.trans.__("Settings to be passed to %1 in `workspace/didChangeConfiguration` notification.",t.display_name):d.description=this.options.trans.__("Settings that would be passed to `%1` server (this server was not detected as installed during startup) in `workspace/didChangeConfiguration` notification.",t.display_name),d.title=this.options.trans.__("Workspace Configuration");for(let[e,t]of Object.entries(d.properties))if("object"==typeof(c=t)&&null!==c&&("type"in c||"$ref"in c)&&void 0!==t.$ref)if(t.$ref.startsWith("#/definitions/")){const n=t.$ref.substring(14),i=d.definitions[n];null==i&&this.console.warn("Definition not found");for(let[t,n]of Object.entries(i))d.properties[e][t]=n;delete t.$ref}else this.console.warn("Unsupported $ref",t.$ref);const u=t.workspace_configuration;if(u)for(const[t,n]of Object.entries(u))d.properties.hasOwnProperty(t)?d.properties[t].default=n:this.console.warn("`workspace_configuration` includes an override for key not in schema",t,e);const p=l&&l.hasOwnProperty(e)?l[e]:{};if(p.serverSettings)for(const[t,n]of Object.entries(p.serverSettings))d.properties.hasOwnProperty(t)?d.properties[t].default=n:this.console.warn("`overrides.json` includes an override for key not in schema",t,e);const g=Sn(d.properties),h=o.JSONExt.deepCopy(i);h.properties.serverSettings=d,s[e]=h,r[e]={...a,...p,serverSettings:g}}var c;t.properties.language_servers.properties=s,t.properties.language_servers.default=r,this._validateSchemaLater(e,t).catch(this.console.warn),this._defaults=r}async normalizeSettings(e){if(await this._defaultsPopulated.promise,null!==this._lastUserServerSettings&&null!==this._lastUserServerSettingsDoted&&o.JSONExt.deepEqual(this._lastUserServerSettings,e.language_servers))e.language_servers=this._lastUserServerSettingsDoted;else{this._lastUserServerSettings=e.language_servers;const t=this._collapseServerSettingsDotted(this._defaults),n=this._collapseServerSettingsDotted(e.language_servers);e.language_servers=this._mergeByServer(t.settings,n.settings),this._lastUserServerSettingsDoted=e.language_servers,Object.keys(n.conflicts).length>0&&this._warnConflicts(n.conflicts,"Conflicts in user settings").catch(this.console.warn),Object.keys(t.conflicts).length>0&&this._warnConflicts(t.conflicts,"Conflicts in defaults").catch(this.console.warn)}return e}_wasPreviouslyValidated(e,t){return null!==this._lastValidation&&this._lastValidation.rawUserSettings===e.raw&&o.JSONExt.deepEqual(this._lastValidation.schema,t)}async _validateSchemaLater(e,t){if(await this.options.restored,this._wasPreviouslyValidated(e,t))return;this._validationAttempt+=1;const n=this.options.settingRegistry.validator.validateData({id:`lsp-validation-attempt-${this._validationAttempt}`,raw:e.raw,data:{composite:{},user:{}},version:e.version,schema:t},!0);this._lastValidation={rawUserSettings:e.raw,schema:t},n&&(console.error("LSP server settings validation failed; graphical interface for settings will run in schema-free mode; errors:",n),this._validationErrors=n,this._schemaValidated.emit(n),this._original?(this._original.properties.language_servers.properties||delete t.properties.language_servers.properties,this._original.properties.language_servers.default||delete t.properties.language_servers.default):console.error("Original language servers schema not available to restore non-transformed values."),await this.options.settingRegistry.reload(e.id))}async _warnConflicts(e,t){await this.options.restored,(0,V.showDialog)({body:_n({conflicts:e,trans:this.options.trans}),title:t,buttons:[V.Dialog.okButton()]}).catch(console.warn)}_collapseServerSettingsDotted(e){const t={},n=o.JSONExt.deepCopy(e);for(let[i,o]of Object.entries(e)){if(!o||!o.serverSettings)continue;const e=pt(o.serverSettings);Object.keys(e.conflicts).length&&(t[i]=e.conflicts),n[i].serverSettings=e.result}return{settings:n,conflicts:t}}_mergeByServer(e,t){const n=o.JSONExt.deepCopy(e);for(let[e,i]of Object.entries(t))if(i&&i.serverSettings)if(void 0===n[e])n[e]=o.JSONExt.deepCopy(i);else{const t={priority:n[e].priority||i.priority,serverSettings:{...n[e].serverSettings||{},...i.serverSettings||{}}};n[e]=t}return n}}let Dn={python:[new c({language:"python",pattern:"^%%(python|python2|python3|pypy)( .*?)?\n([^]*)",foreignCaptureGroups:[3],isStandalone:!0,fileExtension:"py"}),new c({language:"perl",pattern:"^%%(perl)( .*?)?\n([^]*)",foreignCaptureGroups:[3],isStandalone:!0,fileExtension:"pl"}),new c({language:"ruby",pattern:"^%%(ruby)( .*?)?\n([^]*)",foreignCaptureGroups:[3],isStandalone:!0,fileExtension:"rb"}),new c({language:"sh",pattern:"^%%(sh|bash)( .*?)?\n([^]*)",foreignCaptureGroups:[3],isStandalone:!0,fileExtension:"sh"}),new c({language:"html",pattern:"^%%(html --isolated)( .*?)?\n([^]*)",foreignCaptureGroups:[3],isStandalone:!0,fileExtension:"html"}),new c({language:"javascript",pattern:"^%%(js|javascript)( .*?)?\n([^]*)",foreignCaptureGroups:[3],isStandalone:!1,fileExtension:"js"}),new c({language:"html",pattern:"^%%(?!html --isolated)(html)( .*?)?\n([^]*)",foreignCaptureGroups:[3],isStandalone:!1,fileExtension:"html"}),new c({language:"latex",pattern:"^%%(latex)( .*?)?\n([^]*)",foreignCaptureGroups:[3],isStandalone:!1,fileExtension:"tex"}),new c({language:"markdown",pattern:"^%%(markdown)( .*?)?\n([^]*)",foreignCaptureGroups:[3],isStandalone:!1,fileExtension:"md"})]};function Bn(e){return e.replace(/\\([\\"])/g,"$1")}function Rn(e){return e?function(e){return e.replace(/(["\\])/g,"\\$1")}(e):""}const Tn="^(\\s*|\\s*\\S+\\s*=\\s*)",In="([^?\\s'\"\\(\\)-\\+\\/#]+)";let Pn=[{pattern:Tn+"!([^=\\s]+)(.*)(\n)?",replacement:'$1get_ipython().getoutput("$2$3")$4',scope:"line",reverse:{pattern:'get_ipython\\(\\).getoutput\\("(.*?)"\\)(\n)?',replacement:"!$1$2",scope:"line"}},{pattern:"^(\\s*)(\\?{1,2})"+In+"(\n)?$",replacement:(e,t,n,i,o)=>`${t}get_ipython().run_line_magic('${"?"==n?"pinfo":"pinfo2"}', '${i}')${o=o||""}`,scope:"line",reverse:{pattern:"get_ipython\\(\\).run_line_magic\\('(pinfo2?)', '(.*?)'\\)(\n)?",replacement:(e,t,n)=>`${"pinfo"==t?"?":"??"}${n}`,scope:"line"}},{pattern:"^(\\s*)"+In+"(\\?{1,2})(\n)?",replacement:(e,t,n,i,o)=>`${t}get_ipython().run_line_magic('${"?"==i?"pinfo":"pinfo2"}',  '${n}')${o=o||""}`,scope:"line",reverse:{pattern:"get_ipython\\(\\).run_line_magic\\('(pinfo2?)',  '(.*?)'\\)(\n)?",replacement:(e,t,n)=>`${n}${"pinfo"==t?"?":"??"}`,scope:"line"}},{pattern:Tn+"%(\\S+)(.*)(\n)?",replacement:(e,t,n,i,o)=>`${t}get_ipython().run_line_magic("${n}", "${i=Rn(i)}")${o=o||""}`,scope:"line",reverse:{pattern:'get_ipython\\(\\).run_line_magic\\("(.*?)", "(.*?)"\\)(\n)?',replacement:(e,t,n)=>`%${t}${n=Bn(n)}`,scope:"line"}},{pattern:"^%%(\\S+)(.*\n)([\\s\\S]*)",replacement:(e,t,n,i,o,r)=>((n=Rn(n))&&(n=n.slice(0,-1)),`get_ipython().run_cell_magic("${t}", "${n}", """${i=i.replace(/"""/g,'\\"\\"\\"')}""")`),scope:"cell",reverse:{pattern:'^get_ipython\\(\\).run_cell_magic\\("(.*?)", "(.*?)", """([\\s\\S]*)"""\\)',replacement:(e,t,n,i)=>(i=i.replace(/\\"\\"\\"/g,'"""'),`%%${t}${n=Bn(n)}\n${i}`),scope:"cell"}}];const Ln={id:r+":ipython",requires:[a.ILSPCodeExtractorsManager,d],activate:(e,t,n)=>{for(let e of Object.keys(Dn))for(let n of Dn[e])t.register(n,e);for(let e of Pn)n.register(e,"python")},autoStart:!0},On="(?:"+["-l","--connections"].join("|")+"|"+["--destination_table","--project","--use_bqstorage_api","--use_rest_api","--use_legacy_sql","--verbose","--params"].map((e=>e+" \\w+")).join("|")+")";let Fn={python:[new c({language:"sql",pattern:`^%%bigquery(?: (?:(?:(?:.*?)://(?:.*))|${On}|(?:\\w+ << )|(?:\\w+@\\w+)))?\n?((?:.+\n)?(?:[^]*))`,foreignCaptureGroups:[1],isStandalone:!0,fileExtension:"sql"})]};const Nn={id:r+":ipython-bigquery",requires:[a.ILSPCodeExtractorsManager],activate:(e,t)=>{for(let e of Object.keys(Fn))for(let n of Fn[e])t.register(n,e)},autoStart:!0};function zn(e,t){let n=[],i=[],o=[];for(let t=0;t<e.length;t+=2){let r=e[t],s=e[t+1];if(null==r)break;"i"===r||"-input"===r?n.push(s):"o"===r||"-output"===r?i.push(s):o.push("-"+r+" "+s)}return{inputs:n,outputs:i,rest:e[e.length+t],others:o}}function Hn(e,t){let{inputs:n,outputs:i,rest:o,others:r}=zn(e,t),s=n.join(", ");s&&(s=", "+s);let a=i.join(", ");return a&&(a+=" = "),{content:o,others:r.join(" "),inputs:s,outputs:a}}function Vn(e='"',t=!1,n="R"){return"(\\S+)?"+"(?:, (\\S+))?".repeat(9)+"( = )?rpy2\\.ipython\\.rmagic\\.RMagics."+n+"\\("+e+(t?"([\\s\\S]*)":"(.*?)")+e+', "(.*?)"'+"(?:, (\\S+))?".repeat(10)+"\\)"}function qn(e,...t){let n=[];for(let e=0;e<10&&null!=t[e];e++)n.push(t[e]);let i=[];for(let e=13;e<23&&null!=t[e];e++)i.push(t[e]);let o=i.join(" -i ");o&&(o=" -i "+o);let r=n.join(" -o ");r&&(r=" -o "+r);let s=t[11],a=t[12];return a&&(a=" "+a),{input:o,output:r,other:a,contents:s}}function $n(e){return"(?: -(\\S+) (\\S+))?".repeat(e)}function Wn(e){return function(t,...n){let i,o=zn(n,-3);return i=null==o.rest?"":e&&o.rest.startsWith(" ")?o.rest.slice(1):o.rest,i}}const Un=Wn(!1);function Gn(e,...t){let n=zn(t,-3).inputs.map((e=>e+" <- data.frame();")).join(" "),i=Un(e,...t);return""!==n&&i&&(n+=" "),n}let Zn={python:[new c({language:"r",pattern:"^%%R"+$n(10)+"\n([^]*)",foreignCaptureGroups:[21],foreignReplacer:Un,extractArguments:Gn,isStandalone:!1,fileExtension:"R"}),new c({language:"r",pattern:"(?:^|\n)%R"+$n(10)+"(?: (.*))?(?:\n|$)",foreignCaptureGroups:[21],foreignReplacer:Wn(!0),extractArguments:Gn,isStandalone:!1,fileExtension:"R"})]},Jn=[{pattern:Tn+"%R"+$n(10)+"( .*)?(\n|$)",replacement:(e,t,...n)=>{let i=Hn(n,-4);return`${t}${i.outputs}rpy2.ipython.rmagic.RMagics.R("${i.content||""}", "${i.others}"${i.inputs})`},scope:"line",reverse:{pattern:Vn(),replacement:(e,...t)=>{let n=qn(e,...t);return"%R"+n.input+n.output+n.other+n.contents},scope:"line"}},{pattern:"^%%R"+$n(10)+"(\n)?([\\s\\S]*)",replacement:(e,...t)=>{let n=Hn(t,-3);return`${n.outputs}rpy2.ipython.rmagic.RMagics.R("""${n.content}""", "${n.others}"${n.inputs})`},scope:"cell",reverse:{pattern:Vn('"""',!0),replacement:(e,...t)=>{let n=qn(e,...t);return"%%R"+n.input+n.output+n.other+"\n"+n.contents},scope:"cell"}},{pattern:Tn+"%Rdevice( .*)?(\n|$)",replacement:(e,t,...n)=>`${t}rpy2.ipython.rmagic.RMagics.Rdevice("${n[0]}", "")`,scope:"line",reverse:{pattern:Vn('"',!1,"Rdevice"),replacement:(e,...t)=>{let n=qn(e,...t);return"%Rdevice"+n.input+n.output+n.other+n.contents},scope:"line"}}];const Kn={id:r+":ipython-rpy2",requires:[a.ILSPCodeExtractorsManager,d],activate:(e,t,n)=>{for(let e of Object.keys(Zn))for(let n of Zn[e])t.register(n,e);for(let e of Jn)n.register(e,"python")},autoStart:!0},Yn="(?:(?:.*?)://(?:.*))",Xn="(?:"+["-l","--connections"].join("|")+"|"+["-x","--close","-c","--creator","-p","--persist","--append"].map((e=>e+" \\w+")).join("|")+")";let Qn={python:[new c({language:"sql",pattern:`^%%sql(?: (?:${Yn}|${Xn}|(?:\\w+ << )|(?:\\w+@\\w+)))?\n?((?:.+\n)?(?:[^]*))`,foreignCaptureGroups:[1],isStandalone:!0,fileExtension:"sql"}),new c({language:"sql",pattern:`(?:^|\n)%sql (?:${Yn}|${Xn}|(.*))\n?`,foreignCaptureGroups:[1],isStandalone:!1,fileExtension:"sql"})]};const ei=[Kn,{id:r+":ipython-sql",requires:[a.ILSPCodeExtractorsManager],activate:(e,t)=>{for(let e of Object.keys(Qn))for(let n of Qn[e])t.register(n,e)},autoStart:!0},Nn,Ln],ti=r+":plugin";class ni{get connectionManager(){return this._connectionManager}_isAnyActive(){const e=[...this._connectionManager.adapters.values()];return null!==this.app.shell.currentWidget&&e.some((e=>e.widget==this.app.shell.currentWidget))}constructor(e,t,n,i,o,s,a,l){this.app=e,this.settingRegistry=t,this.console=i,this.translator=o,this.userConsole=s;const c=(o||A.nullTranslator).load("jupyterlab_lsp");this.languageServerManager=n.languageServerManager,this._connectionManager=n;const d=new ae({languageServerManager:this.languageServerManager,connectionManager:this.connectionManager,translatorBundle:c,shell:e.shell});if(null!==a?a.registerStatusItem(r+":language-server-status",{item:d.createItem(),align:"left",rank:1,isActive:()=>this._isAnyActive()}):e.docRegistry.addWidgetExtension("Notebook",d),this._settingsSchemaManager=new Mn({settingRegistry:this.settingRegistry,languageServerManager:this.languageServerManager,trans:c,console:this.console.scope("SettingsSchemaManager"),restored:e.restored}),null!=l){const e=new jn({settingRegistry:this.settingRegistry,console:this.console.scope("SettingsUIManager"),languageServerManager:this.languageServerManager,trans:c,schemaValidated:this._settingsSchemaManager.schemaValidated});l.addRenderer(`${ti}.language_servers`,{fieldRenderer:e.renderForm.bind(e)})}this._settingsSchemaManager.setupSchemaTransform(ii.id).then(this._activate.bind(this)).catch(this._activate.bind(this))}_activate(){this.settingRegistry.load(ii.id).then((async e=>{await this._updateOptions(e,!1),e.changed.connect((async()=>{await this._updateOptions(e,!0)}))})).catch((e=>{console.error(e.message)}))}async _updateOptions(e,t=!1){const n=await this._settingsSchemaManager.normalizeSettings(e.composite);let i=n.language_servers||{};i=Object.fromEntries(Object.entries(i).map((([e,t])=>(t.configuration=t.serverSettings,t.rank=t.priority,[e,t]))));const o=this._connectionManager.initialConfigurations;this._connectionManager.initialConfigurations=i,this.connectionManager.updateConfiguration(i),t?this.connectionManager.updateServerConfigurations(i):o!=i&&this.connectionManager.ready.then((()=>{this.connectionManager.updateServerConfigurations(i)})).catch(console.error),this._connectionManager.updateLogging(n.logAllCommunication,n.setTrace)}}const ii={id:ti,requires:[m.ISettingRegistry,a.ILSPDocumentConnectionManager,s,A.ITranslator],optional:[h.ILoggerRegistry,f.IStatusBar,v.IFormRendererRegistry],activate:(e,...t)=>{new ni(e,...t)},autoStart:!0},oi=[vt,Ke,fn,en,cn,Ut,Ht,En],ri=[Ne,u.COMPLETION_THEME_MANAGER,g.plugin,p.plugin,bn,H,F,ii,...ei,...oi]}}]);
//# sourceMappingURL=661.3b0a35b5a2d472d5afbe.js.map?v=3b0a35b5a2d472d5afbe